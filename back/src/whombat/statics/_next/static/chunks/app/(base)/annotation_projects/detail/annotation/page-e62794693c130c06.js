(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3440],{94137:function(e,t,n){Promise.resolve().then(n.bind(n,72663))},72663:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return e5}});var a,r,l=n(14357),i=n(6439),o=n(52315),s=n(29050),c=n(32091),d=n(9078),u=n(68840),m=n(38425),g=n(60169),f=n(56793),x=n(96489),p=n(57119),h=n(47044);let v=[{name:"Pending",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.vN,{prefix:"pending",setFilter:t})},description:"Select only tasks that are pending",icon:(0,l.jsx)(f.dY,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{name:"Verified",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.vN,{prefix:"verified",setFilter:t})},description:"Select tasks by their verified status",icon:(0,l.jsx)(f.SA,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{name:"Needs Review",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.vN,{prefix:"rejected",setFilter:t})},description:"Select tasks by their review status",icon:(0,l.jsx)(f.wv,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{name:"Assigned",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.vN,{prefix:"assigned",setFilter:t})},description:"Select tasks that have been assigned",icon:(0,l.jsx)(f.tB,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{name:"Assigned to me",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.vN,{prefix:"assigned_to",setFilter:t})},description:"Select tasks that have been assigned to you",icon:(0,l.jsx)(f.tB,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{name:"Dataset",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.P9,{setFilter:t})},description:"Select tasks that come from a specific dataset",icon:(0,l.jsx)(f.lQ,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{name:"Recording Tag",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(h.D3,{prefix:"recording_tag",setFilter:t})},description:"Select task that come from a recording with a specific tag",icon:(0,l.jsx)(f.lO,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})}];function y(e){var t;let{pending:n,complete:a,filter:r,next:i,previous:o}=e;return(0,l.jsxs)("div",{className:"inline-flex items-center gap-1 w-100",children:[(0,l.jsx)(p.Z,{tooltip:"Previous Task",placement:"bottom",children:(0,l.jsx)(g.Z,{mode:"text",padding:"p-1",onClick:o,children:(0,l.jsx)(f.jJ,{className:"w-5 h-5 inline-block"})})}),(0,l.jsxs)("div",{className:"inline-flex gap-4 items-center rounded-lg border dark:border-stone-800 px-2 py-1 grow",children:[(0,l.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,l.jsx)("span",{className:"text-stone-500 text-sm",children:"Progress:"}),(0,l.jsx)("div",{className:"w-36",children:(0,l.jsx)(d.Z,{total:n+a,complete:a,className:"mb-0"})})]}),(0,l.jsxs)("span",{className:"text-stone-500 text-sm whitespace-nowrap align-middle",children:["Remaining: ",(0,l.jsx)("span",{className:"text-blue-500 font-medium",children:n})]}),(0,l.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,l.jsx)("span",{className:"text-stone-500 text-sm",children:"Pending:"}),(0,l.jsx)(x.Z,{label:"Only Pending",checked:null!==(t=r.get("pending__eq"))&&void 0!==t&&t,onChange:e=>{e?r.set("pending__eq",e,!0):r.clear("pending__eq",!0)}})]}),(0,l.jsx)(u.Z,{filter:r,filterDefs:v,className:(0,g.y)({variant:"info",mode:"text",padding:"p-1"}),button:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.k1,{className:"w-5 h-5 inline-block mr-1"}),(0,l.jsx)("span",{className:"text-sm whitespace-nowrap align-middle",children:"Filters"})]})}),(0,l.jsx)("div",{className:"overflow-x-scroll",children:(0,l.jsx)(m.C,{withLabel:!1,filter:r})})]}),(0,l.jsx)(p.Z,{tooltip:"Next Task",placement:"bottom",children:(0,l.jsx)(g.Z,{mode:"text",padding:"p-1",onClick:i,children:(0,l.jsx)(f.Ne,{className:"w-5 h-5 inline-block"})})})]})}var b=n(8554),w=n(91293),j=n(89462),k=n(24957),N=n(90185),C=n(33330),T=n(30485),E=n(40072),Z=n(17526),S=n(2915),A=n(99093),_=n(78877),D=n(37301),P=n(29554),M=n(5374),L=n.n(M),F=n(69708);function B(e){let{onClose:t,onAdd:n,onCreate:a,filter:r,...i}=e;return(0,l.jsx)(F.Z,{onSelect:e=>{null==n||n(e)},onCreate:a,autoFocus:!0,onKeyDown:e=>{"Escape"===e.key?null==t||t():"Enter"===e.key&&(null==t||t())},initialFilter:r,...i})}function I(e){let{tag:t,onClick:n}=e,a=(0,o.Z)(e=>e.getTagColor),r=a(t.tag),s=(0,i.useMemo)(()=>"bg-".concat(r.color,"-500"),[r]);return(0,l.jsxs)("span",{className:"transition-all group flex flex-row items-center gap-1 rounded-full bg-stone-200/0 dark:bg-stone-800/0 px-2 hover:bg-stone-200 hover:dark:bg-stone-800",children:[(0,l.jsx)("span",{className:"inline-block my-2 w-2 h-2 rounded-full ".concat(s," ring-1 ring-stone-900 opacity-100")}),(0,l.jsxs)("button",{type:"button",className:"transition-all text-stone-800 dark:text-stone-400 flex-row items-center gap-1 hidden opacity-0 group-hover:flex group-hover:opacity-100 hover:text-red-500",onClick:n,children:[(0,l.jsx)("span",{className:"transition-all whitespace-nowrap text-xs font-thin hidden opacity-0 group-hover:inline-block group-hover:opacity-100",children:t.tag.key}),(0,l.jsx)("span",{className:"transition-all whitespace-nowrap text-sm font-medium hidden opacity-0 group-hover:inline-block group-hover:opacity-100",children:t.tag.value}),(0,l.jsx)(f.Tw,{className:"w-3 h-3 stroke-2 inline-block"})]})]})}function q(e){let{filter:t,onCreate:n,onAdd:a}=e;return(0,l.jsx)(D.J,{as:"div",children:(0,l.jsxs)(P.bv,{zIndex:999,placement:"bottom",offset:4,enter:"transition duration-200 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition duration-150 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",portal:!0,children:[(0,l.jsxs)(D.J.Button,{className:"group focus:outline-none rounded focus:ring-4 focus:ring-emerald-500/50 hover:text-emerald-500",children:["+",(0,l.jsx)(f.lO,{className:"w-4 h-4 inline-block ml-1 stroke-2"}),(0,l.jsx)("span",{className:"absolute whitespace-nowrap hidden transition-all duration-200 ml-1 opacity-0 group-hover:inline-block group-hover:opacity-100",children:"Add tag"})]}),(0,l.jsx)(D.J.Panel,{className:"w-52",focus:!0,unmount:!0,children:e=>{let{close:r}=e;return(0,l.jsx)(B,{filter:t,onClose:r,onCreate:e=>{null==n||n(e),r()},onAdd:e=>{null==a||a(e),r()}})}})]})})}function R(e){let{group:t,filter:n,onCreate:a}=e,{x:r,y:i}=t.position;return(0,l.jsxs)("div",{className:L()({"pointer-events-none":!t.active},"h-5 flex flex-col gap-2 absolute px-2 text-stone-300 "),style:{left:r,top:i},children:[(0,l.jsx)("div",{className:"relative right-0",children:t.tags.map(e=>(0,l.jsx)(I,{...e},e.tag.id))}),(0,l.jsx)(q,{filter:n,onCreate:e=>{null==a||a(e),t.onAdd(e)},onAdd:e=>{t.onAdd(e)}})]})}function O(e){let{tags:t,children:n,filter:a,onCreate:r}=e;return(0,l.jsxs)("div",{className:"rounded w-full h-full relative overflow-hidden",children:[n,t.map(e=>(0,l.jsx)(R,{group:e,filter:a,onCreate:r},e.annotation.id))]})}var W=n(61425);let z={TimeStamp:{id:"TimeStamp",label:(0,l.jsx)(f.VE,{className:"w-5 h-5"}),value:"TimeStamp"},TimeInterval:{id:"TimeInterval",label:(0,l.jsx)(f.jE,{className:"w-5 h-5"}),value:"TimeInterval"},BoundingBox:{id:"BoundingBox",label:(0,l.jsx)(f.Iz,{className:"w-5 h-5"}),value:"BoundingBox"}};function H(e){let{isDrawing:t,isDeleting:n,isSelecting:a,isEditing:r,geometryType:i,onDraw:o,onDelete:s,onSelect:c,onSelectGeometryType:d}=e;return(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(p.Z,{tooltip:"Create a new annotation",placement:"bottom",children:(0,l.jsx)(g.Z,{variant:t?"primary":"secondary",onClick:o,children:(0,l.jsx)(f.O4,{className:"w-5 h-5"})})}),r?(0,l.jsx)(g.Z,{variant:"warning",onClick:c,children:(0,l.jsx)(f.dY,{className:"w-5 h-5"})}):(0,l.jsx)(p.Z,{tooltip:"Select an annotation",placement:"bottom",children:(0,l.jsx)(g.Z,{variant:a?"primary":"secondary",onClick:c,children:(0,l.jsx)(f.GV,{className:"w-5 h-5"})})}),(0,l.jsx)(p.Z,{tooltip:"Delete an annotation",placement:"bottom",children:(0,l.jsx)(g.Z,{variant:n?"danger":"secondary",onClick:s,children:(0,l.jsx)(f.pJ,{className:"w-5 h-5"})})}),(0,l.jsx)(W.Z,{placement:"bottom",options:Object.values(z),selected:z[i],onChange:e=>d(e)})]})}var G=n(29837),Q=n(78470),Y=n(81741),K=n(56205),V=n(32717),X=n(12021),J=n(54083);let{stop:U}=Q,$={selectGeometryType:(0,Y.f0)({geometryType:(e,t)=>t.geometryType}),updateSelectedAnnotation:(0,Y.f0)({selectedAnnotation:(e,t)=>t.data}),clearCreationGeometry:(0,Y.f0)({geometryToCreate:null}),startAnnotationCreation:(0,Y.f0)({geometryToCreate:(e,t)=>t.geometry}),finishAnnotationCreation:(0,Y.f0)({selectedAnnotation:(e,t)=>t.data}),disableSpectrogram:e=>{var t;null===(t=e.spectrogram)||void 0===t||t.send({type:"DISABLE"})},enableSpectrogram:e=>{var t;null===(t=e.spectrogram)||void 0===t||t.send({type:"PAN"})},changeTask:(0,Y.f0)({task:(e,t)=>t.task,recording:(e,t)=>t.task.clip.recording}),setupSpectrogram:(0,Y.f0)({spectrogram:e=>{null!=e.spectrogram&&U(e=>e.spectrogram);let{task:t,parameters:n}=e,{recording:a}=t.clip,r={time:{min:t.clip.start_time,max:t.clip.end_time},freq:{min:0,max:a.samplerate/2}},l=(0,J.Hs)({interval:r.time,samplerate:a.samplerate,window_size:n.window_size,hop_size:n.hop_size}),i={time:{min:t.clip.start_time,max:Math.min(t.clip.end_time,t.clip.start_time+l)},freq:{min:0,max:a.samplerate/2}};return(0,K.Cs)(X.nk.withContext({recording:a,parameters:n,bounds:r,initial:i,window:i}))}}),selectAnnotation:(0,Y.f0)({selectedAnnotation:(e,t)=>t.annotation}),clearSelectedAnnotation:e=>(0,Y.f0)({selectedAnnotation:null})},ee=(0,V.C)({predictableActionArguments:!0,schema:{context:{},events:{}},id:"annotate",initial:"setup",states:{setup:{exit:["setupSpectrogram"],always:"idle"},idle:{entry:["enableSpectrogram"],exit:["disableSpectrogram"]},edit:{id:"edit",exit:["clearSelectedAnnotation"],initial:"selecting",states:{selecting:{on:{SELECT_ANNOTATION:{target:"editing",actions:"selectAnnotation"}}},editing:{on:{EDIT:{target:"updating"},CREATE:{target:"#create.creating",actions:"startAnnotationCreation"}}},updating:{invoke:{src:"updateAnnotationGeometry",onDone:{target:"editing",actions:"updateSelectedAnnotation"},onError:{target:"editing"}}}}},create:{id:"create",initial:"drawing",states:{drawing:{on:{CREATE:{target:"creating",actions:"startAnnotationCreation"}}},creating:{invoke:{src:"createAnnotation",onDone:{target:"#edit.editing",actions:"finishAnnotationCreation"},onError:{target:"drawing"}},exit:["clearCreationGeometry"]}}},delete:{initial:"selecting",states:{selecting:{on:{DELETE_ANNOTATION:{target:"deleting"}}},deleting:{invoke:{src:"deleteAnnotation",onDone:{target:"#annotate"},onError:{target:"selecting"}}}}}},on:{IDLE:"idle",SELECT:"edit",DRAW:"create",DELETE:"delete",RESET:{actions:["reset"],target:"idle"},ADD_TAG:{actions:["addTag"]},REMOVE_TAG:{actions:["removeTag"]},ADD_NOTE:{actions:["addNote"]},UPDATE_NOTE:{actions:["updateNote"]},REMOVE_NOTE:{actions:["removeNote"]},SELECT_GEOMETRY_TYPE:{actions:["selectGeometryType"]},CHANGE_TASK:{actions:["changeTask"],target:"setup"}}},{actions:$});var et=n(55766),en=n(89837),ea=n(95086),er=n(41810),el=function(e,t,n,a){void 0===t&&(t=er.ZT),void 0===n&&(n={}),void 0===a&&(a=[e]);var r=n.event,l=void 0===r?"keydown":r,o=n.target,s=n.options,c=(0,i.useMemo)(function(){var n="function"==typeof e?e:"string"==typeof e?function(t){return t.key===e}:e?function(){return!0}:function(){return!1};return function(e){if(n(e))return t(e)}},a);(0,ea.Z)(l,c,o,s)},ei=function(e){var t=(0,i.useState)([!1,null]),n=t[0],a=t[1];return el(e,function(e){return a([!0,e])},{event:"keydown"},[n]),el(e,function(e){return a([!1,e])},{event:"keyup"},[n]),n},eo=n(49763),es=function(e,t,n,a){void 0===a&&(a=ei);var r=a(e),l=r[0],i=r[1];(0,eo.Z)(function(){!l&&n?n(i):l&&t&&t(i)},[l])},ec=n(57142),ed=n(60978),eu=n(12148),em=n(28775);let eg="rgb(16 185 129)",ef={borderColor:eg,fillColor:eg,borderWidth:2,borderDash:[5,5],fillAlpha:.2};var ex=n(23076),ep=n(17010),eh=n(82943),ev=n(30291);let ey={borderColor:ev.Vb,borderWidth:1,size:7};function eb(e,t){let{size:n=6,...a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ey,[r,l]=t;(0,ev.F6)(e,a),e.strokeRect(r-n/2,l-n/2,n,n)}let ew=ev._8,ej=ev._8;function ek(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{length:n}=e.coordinates,a=e.coordinates.map((e,t)=>({type:"Keypoint",coords:e,drag:(e,n,a)=>{let r=[...e.coordinates],l=a[0]-n[0],i=a[1]-n[1],o=r[t];return r[t]=[o[0]+l,o[1]+i],{type:"LineString",coordinates:r}}})),r=e.coordinates.slice(t?0:1).map((a,r)=>{let l=e.coordinates[t?(n+r-1)%n:r];return{type:"Edge",coords:[l,a],drag:(e,a,l)=>{let i=t?(n+r-1)%n:r,o=t?r:r+1,s=[...e.coordinates],c=l[0]-a[0],d=l[1]-a[1],u=s[i];s[i]=[u[0]+c,u[1]+d];let m=s[o];return s[o]=[m[0]+c,m[1]+d],{type:"LineString",coordinates:s}}}});return[...a,...r]}function eN(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.coordinates.forEach((e,a)=>{n.push(...ek({type:"LineString",coordinates:e},t).map(e=>(function(e,t){let{drag:n}=e;return{...e,drag:(e,a,r)=>{let l=[...e.coordinates],i=n({type:"LineString",coordinates:l[t]},a,r).coordinates;return l[t]=i,{type:"MultiLineString",coordinates:l}}}})(e,a)))}),n}function eC(e){let{drag:t}=e;return{...e,drag:(e,n,a)=>{let r=t({type:"MultiLineString",coordinates:e.coordinates},n,a).coordinates;return{type:"Polygon",coordinates:r}}}}function eT(e){let t=eN({type:"MultiLineString",coordinates:e.coordinates},!0).map(eC),n={type:"Area",coords:e.coordinates,drag:(e,t,n)=>(0,en.zM)(e,t,n)};return t.push(n),t}let eE=(a=function(e,t){let{type:n}=e;switch(n){case"TimeStamp":return function(e,t){let{height:n}=t,a=e.coordinates;return[{type:"Edge",coords:[[a,0],[a,n]],drag:(e,t,n)=>{let a=n[0]-t[0];return{type:"TimeStamp",coordinates:e.coordinates+a}}}]}(e,t);case"TimeInterval":return function(e,t){let{height:n}=t,[a,r]=e.coordinates;return[{type:"Edge",coords:[[a,0],[a,n]],drag:(e,t,n)=>{let a=n[0]-t[0],[r,l]=e.coordinates;return{type:"TimeInterval",coordinates:[r+a,l]}}},{type:"Edge",coords:[[r,0],[r,n]],drag:(e,t,n)=>{let a=n[0]-t[0],[r,l]=e.coordinates;return{type:"TimeInterval",coordinates:[r,l+a]}}},{type:"Area",coords:[[[a,n],[a,0],[r,0],[r,n]]],drag:(e,t,n)=>{let a=n[0]-t[0],[r,l]=e.coordinates;return{type:"TimeInterval",coordinates:[r+a,l+a]}}}]}(e,t);case"BoundingBox":return function(e){let[t,n,a,r]=e.coordinates;return[{type:"Keypoint",coords:[t,n],drag:(e,t,n)=>{let a=n[0]-t[0],r=n[1]-t[1],[l,i,o,s]=e.coordinates;return{type:"BoundingBox",coordinates:[l+a,i+r,o,s]}}},{type:"Keypoint",coords:[t,r],drag:(e,t,n)=>{let a=n[0]-t[0],r=n[1]-t[1],[l,i,o,s]=e.coordinates;return{type:"BoundingBox",coordinates:[l+a,i,o,s+r]}}},{type:"Keypoint",coords:[a,n],drag:(e,t,n)=>{let a=n[0]-t[0],r=n[1]-t[1],[l,i,o,s]=e.coordinates;return{type:"BoundingBox",coordinates:[l,i+r,o+a,s]}}},{type:"Keypoint",coords:[a,r],drag:(e,t,n)=>{let a=n[0]-t[0],r=n[1]-t[1],[l,i,o,s]=e.coordinates;return{type:"BoundingBox",coordinates:[l,i,o+a,s+r]}}},{type:"Edge",coords:[[t,n],[t,r]],drag:(e,t,n)=>{let a=n[0]-t[0],[r,l,i,o]=e.coordinates;return{type:"BoundingBox",coordinates:[r+a,l,i,o]}}},{type:"Edge",coords:[[t,r],[a,r]],drag:(e,t,n)=>{let a=n[1]-t[1],[r,l,i,o]=e.coordinates;return{type:"BoundingBox",coordinates:[r,l,i,o+a]}}},{type:"Edge",coords:[[a,r],[a,n]],drag:(e,t,n)=>{let a=n[0]-t[0],[r,l,i,o]=e.coordinates;return{type:"BoundingBox",coordinates:[r,l,i+a,o]}}},{type:"Edge",coords:[[a,n],[t,n]],drag:(e,t,n)=>{let a=n[1]-t[1],[r,l,i,o]=e.coordinates;return{type:"BoundingBox",coordinates:[r,l+a,i,o]}}},{type:"Area",coords:[[[t,n],[t,r],[a,r],[a,n]]],drag:(e,t,n)=>{let a=n[0]-t[0],r=n[1]-t[1],[l,i,o,s]=e.coordinates;return{type:"BoundingBox",coordinates:[l+a,i+r,o+a,s+r]}}}]}(e);case"Point":return[{type:"Keypoint",coords:e.coordinates,drag:(e,t,n)=>{let a=n[0]-t[0],r=n[1]-t[1],[l,i]=e.coordinates;return{type:"Point",coordinates:[l+a,i+r]}}}];case"MultiPoint":return e.coordinates.map((e,t)=>({type:"Keypoint",coords:e,drag:(e,n,a)=>{let r=[...e.coordinates],l=a[0]-n[0],i=a[1]-n[1],[o,s]=e.coordinates[t];return r[t]=[o+l,s+i],{type:"MultiPoint",coordinates:r}}}));case"LineString":return ek(e);case"MultiLineString":return eN(e);case"Polygon":return eT(e);case"MultiPolygon":return function(e){let t=[];return e.coordinates.forEach((e,n)=>{t.push(...eT({type:"Polygon",coordinates:e}).map(e=>(function(e,t){let{drag:n}=e;return{...e,drag:(e,a,r)=>{let l=[...e.coordinates],i=n({type:"Polygon",coordinates:l[t]},a,r).coordinates;return l[t]=i,{type:"MultiPolygon",coordinates:l}}}})(e,n)))}),t}(e);default:throw Error}},r=en.vZ,function(e){let{drag:t,mouse:n,object:l,active:o,style:s,onChange:c,onClickAway:d}=e,[u]=ei("Shift"),{elW:m,elH:g}=n,[f,x]=(0,i.useState)(null),p=(0,i.useMemo)(()=>null==l?[]:a(l,{width:m,height:g}),[l,m,g]),h=function(e){let{elements:t,mouse:n,active:a=!0}=e,[r,l]=(0,i.useState)(null),{elX:o,elY:s}=n;return(0,i.useEffect)(()=>{a&&(l(null),t.some((e,t)=>{let n=function(e){let{type:t}=e;switch(t){case"Keypoint":return{type:"Point",coordinates:e.coords};case"Edge":return{type:"LineString",coordinates:e.coords};case"Area":return{type:"Polygon",coordinates:e.coords};default:throw Error()}}(e);return!!(0,en.MR)([o,s],n)&&(l(t),!0)}))},[t,o,s,a]),r}({mouse:n,elements:p,active:o&&!t.isDragging});(0,i.useEffect)(()=>{x(null)},[l]),(0,i.useEffect)(()=>{o&&(t.isDragging&&null==f&&x(l),!t.isDragging&&null!=f&&(x(null),f!==l))&&(null==c||c(f))},[t.isDragging,l,f,o,c]);let{start:v,current:y}=t;(0,i.useEffect)(()=>{if(o&&(null==h&&null!=v&&(null==d||d()),null!=v&&null!=y&&null!=h&&null!=l)){if(u)x(r(l,v,y));else{let e=p[h];null!=e&&x(e.drag(l,v,y))}}},[l,v,y,h,p,o,u,d]);let b=(0,i.useCallback)(e=>{if(!o||null==l)return;e.canvas.style.cursor="default",null!=h&&(e.canvas.style.cursor="pointer",u&&(e.canvas.style.cursor="move")),null!=f&&(e.canvas.style.cursor="grabbing");let t=a(null!=f?f:l,{width:e.canvas.width,height:e.canvas.height});t.forEach((t,n)=>(function(e,t,n,a){let{type:r}=t;switch(r){case"Keypoint":!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];eb(e,t.coords,{size:n?10:5,borderColor:n?ej:ew,borderWidth:n?3:1})}(e,t,a);break;case"Edge":!function(e,t,n){let{borderColor:a,borderWidth:r,borderAlpha:l,borderDash:i}=n,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],[s,c]=t.coords,d=[(s[0]+c[0])/2,(s[1]+c[1])/2];(0,ep.s6)(e,{type:"LineString",coordinates:[s,c]},{borderColor:o?ev._8:a,borderWidth:o?3:r,borderAlpha:l,borderDash:i}),eb(e,d,{size:o?10:5,borderColor:o?ej:ew,borderWidth:o?3:1})}(e,t,n,a);break;case"Area":!function(e,t,n){let{fillAlpha:a,fillColor:r,borderColor:l}=n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,eh.is)(e,{type:"Polygon",coordinates:t.coords},{fillAlpha:i?.3:a,fillColor:i?ev._8:null!=r?r:l,borderWidth:0,borderAlpha:0})}(e,t,n,a)}})(e,t,s,n===h||u&&null!=h))},[o,l,s,h,f,u]);return{object:l,tmpObject:f,isEditing:null!=f,active:o,hovered:h,draw:b}}),eZ="rgb(16 185 129)",eS={borderColor:eZ,fillColor:eZ,borderWidth:2,borderDash:[6,6],fillAlpha:.2};function eA(e){var t;let{mouse:n,annotations:a,window:r,active:l=!0}=e,{elX:o,elY:s,elH:c,elW:d}=n,u=(0,i.useMemo)(()=>{if(!l)return[];let{min:e,max:t}=r.time,{min:n,max:i}=r.freq;return a.filter(a=>{let{geometry:r}=a.sound_event;if(null==r)return!1;switch(r.type){case"Point":let[l,o]=r.coordinates;return l>=e&&l<=t&&o>=n&&o<=i;case"TimeStamp":let s=r.coordinates;return s>=e&&s<=t;case"TimeInterval":let[c,d]=r.coordinates;return d>=e&&c<=t;case"BoundingBox":let[u,m,g,f]=r.coordinates;return g>=e&&u<=t&&f>=n&&m<=i}return!0})},[l,a,r]),m=(0,i.useMemo)(()=>l?u.map(e=>{let{geometry:t}=e.sound_event;return(0,en.w9)({width:d,height:c},t,r)}):[],[l,u,r,d,c]),g=(0,i.useMemo)(()=>{if(!l)return null;let e=m.findIndex(e=>{if(null==e)return!1;let t=(0,en.MR)([o,s],e);return t});return e},[m,o,s,l]);return null==g?null:null!==(t=u[g])&&void 0!==t?t:null}var e_=n(55290),eD=n(75263);function eP(e){let{ref:t,onClick:n,onDblClick:a}=e;(0,i.useEffect)(()=>{let e=0,r=r=>{if(t&&t.current){let{left:l,top:i,width:o,height:s}=t.current.getBoundingClientRect(),c=l+window.scrollX,d=i+window.scrollY,u=r.pageX-c,m=r.pageY-d;switch(r.detail){case 1:e=setTimeout(()=>{null==n||n({position:[u,m],dimensions:{width:o,height:s}})},100);break;case 2:clearTimeout(e),null==a||a({position:[u,m],dimensions:{width:o,height:s}})}}};return(0,eD.on)(document,"click",r),()=>{(0,eD.S1)(document,"click",r)}},[t,n,a])}let eM={borderColor:ev.T,fillColor:ev.T,borderWidth:3,fillAlpha:.2},eL={borderColor:ev.cM,fillColor:ev.cM,borderWidth:2,fillAlpha:.2};var eF=n(81063),eB=n(87283),eI=n(47128),eq=function(e){var t=(0,eI.Z)({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return(0,i.useEffect)(function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),r=n.left,l=n.top,i=n.width,o=n.height,s=r+window.pageXOffset,c=l+window.pageYOffset,d=t.pageX-s,u=t.pageY-c;a({docX:t.pageX,docY:t.pageY,posX:s,posY:c,elX:d,elY:u,elH:o,elW:i})}};return(0,er.on)(document,"mousemove",t),function(){(0,er.S1)(document,"mousemove",t)}},[e]),n},eR=n(81361);function eO(e){let{task:t,annotations:n,recording:a,parameters:r,onAddTag:s,onRemoveTag:c,onCreateAnnotation:d,onUpdateAnnotationGeometry:u,onDeleteAnnotation:m}=e,g=(0,i.useRef)(null),f=(0,ex.Z)({ref:g}),x=eq(g),{state:p,send:h,draw:v,tags:y}=function(e){var t,n,a,r;let{task:l,annotations:o,parameters:s,mouseState:c,scratchState:d,ref:u,onAddTag:m,onRemoveTag:g,onCreateAnnotation:f,onUpdateAnnotationGeometry:x,onDeleteAnnotation:p}=e,[h,v]=(0,G.e)(ee,{context:{task:l,parameters:s,selectedAnnotation:null,geometryType:"BoundingBox"},actions:{addTag:async(e,t)=>{let{annotation:n,tag:a}=t;return await (null==m?void 0:m(n,a))},removeTag:async(e,t)=>{let{annotation:n,tag:a}=t;return await (null==g?void 0:g(n,a))}},services:{createAnnotation:async(e,t)=>{let{geometry:n,tag_ids:a}=t,{task:r}=e;if(null==n)throw Error("No geometry to create");return await (null==f?void 0:f(r,n,a))},updateAnnotationGeometry:async(e,t)=>{let{selectedAnnotation:n}=e,{geometry:a}=t;if(null==n)throw Error("No annotation selected");return await (null==x?void 0:x(n,a))},deleteAnnotation:async(e,t)=>{let{annotation:n}=t;return await (null==p?void 0:p(n))}}});(0,i.useEffect)(()=>{v({type:"CHANGE_TASK",task:l})},[l,v]);let[y,b]=(0,C.L)(h.context.spectrogram);!function(e){let{send:t}=e,n=(0,i.useCallback)(e=>{e.target instanceof HTMLInputElement||t({type:"DRAW"})},[t]),a=(0,i.useCallback)(e=>{e.target instanceof HTMLInputElement||t({type:"SELECT"})},[t]),r=(0,i.useCallback)(e=>{e.target instanceof HTMLInputElement||t({type:"DELETE"})},[t]),l=(0,i.useCallback)(e=>{e.target instanceof HTMLInputElement||t({type:"IDLE"})},[t]);es("d",r),es("a",n),es("e",a),es("Escape",l)}({send:v,cond:h.matches("edit.editing")});let{draw:w}=(0,et.Z)({state:y,send:b,dragState:d,recording:y.context.recording,ref:u}),j=function(e){let{drag:t,window:n,send:a,active:r,geometryType:l="TimeStamp"}=e,o=(0,i.useCallback)(e=>{let{bbox:t,dims:r}=e,l=(0,en.WC)(r,{type:"BoundingBox",coordinates:t},n);a({type:"CREATE",geometry:l})},[a,n]),s=(0,i.useCallback)(e=>{let{interval:t,dims:r}=e,l=(0,en.WC)(r,{type:"TimeInterval",coordinates:t},n);a({type:"CREATE",geometry:l})},[a,n]),c=(0,i.useCallback)(e=>{let{timeStamp:t,dims:r}=e,l=(0,en.WC)(r,{type:"TimeStamp",coordinates:t},n);a({type:"CREATE",geometry:l})},[a,n]),{draw:d}=(0,ec.Z)({drag:t,active:r&&"BoundingBox"===l,onCreate:o,style:ef}),{draw:u}=function(e){let{drag:t,active:n,onCreate:a=()=>null,style:r=eu.X}=e,[l,o]=(0,i.useState)({width:0,height:0}),[s,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!1),{elW:m,elH:g}=t;(0,i.useEffect)(()=>{n&&null!=m&&null!=g&&o({width:m,height:g})},[m,g,n]);let{isDragging:f,start:x,current:p}=(0,ed.Z)({dragState:t,active:n});(0,i.useEffect)(()=>{n&&(f?u(!0):(u(!1),null!=s&&(a({interval:s,dims:l}),c(null))))},[n,f,s,a,l]),(0,i.useEffect)(()=>{if(n&&null!=x&&null!=p){let e=Math.min(x[0],p[0]),t=Math.max(x[0],p[0]);c([e,t])}},[n,p,x]);let h=(0,i.useCallback)(e=>{n&&d&&null!=s&&(0,eu.Z)(e,{min:s[0],max:s[1]},r)},[n,s,d,r]);return{interval:s,isDrawing:d,draw:h}}({drag:t,active:r&&"TimeInterval"===l,onCreate:s,style:ef}),{draw:m}=function(e){let{drag:t,active:n,onCreate:a,style:r=em.n}=e,[l,o]=(0,i.useState)({width:0,height:0}),[s,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!1),{elW:m,elH:g}=t;(0,i.useEffect)(()=>{null!=m&&null!=g&&o({width:m,height:g})},[m,g]);let{isDragging:f,current:x}=(0,ed.Z)({dragState:t,active:n});(0,i.useEffect)(()=>{n&&(f?u(!0):(u(!1),null!=s&&a({timeStamp:s,dims:l})))},[n,f,s,a,l]),(0,i.useEffect)(()=>{if(n){var e;c(null!==(e=null==x?void 0:x[0])&&void 0!==e?e:null)}},[n,x]);let p=(0,i.useCallback)(e=>{n&&d&&null!=s&&(0,em.Z)(e,s,r)},[n,s,r,d]);return{draw:p,timeStamp:s,isDrawing:d}}({drag:t,active:r&&"TimeStamp"===l,onCreate:c,style:ef}),g=(0,i.useCallback)(e=>{if(r){if(e.canvas.style.cursor="crosshair","BoundingBox"===l){d(e);return}if("TimeInterval"===l){u(e);return}if("TimeStamp"===l){m(e);return}}},[r,l,d,u,m]);return g}({drag:d,window:y.context.window,send:v,active:h.matches("create.drawing"),geometryType:h.context.geometryType}),k=function(e){let{mouse:t,active:n,send:a,window:r,annotation:l,ref:o}=e,[s]=ei("Control");(0,i.useEffect)(()=>{},[s]);let c=(0,ex.Z)({ref:o,active:n}),d=(0,ed.Z)({dragState:c,active:n}),u=(0,i.useCallback)(e=>{let t=s?{type:"CREATE",geometry:e,tag_ids:null==l?void 0:l.tags.map(e=>e.tag.id)}:{type:"EDIT",geometry:e};a(t)},[a,s,null==l?void 0:l.tags]),m=(0,i.useCallback)(()=>{a({type:"IDLE"})},[a]),{draw:g}=function(e){var t;let{mouse:n,drag:a,window:r,annotation:l,active:o,onChange:s,onEmptyClick:c,style:d}=e,{geometry:u}=null!==(t=null==l?void 0:l.sound_event)&&void 0!==t?t:{},{elW:m,elH:g}=n,f=(0,i.useMemo)(()=>null==u?null:(0,en.w9)({width:m,height:g},u,r),[u,r,m,g]),x=(0,i.useCallback)(e=>{if(null==e)return;let t=(0,en.WC)({width:m,height:g},e,r);s(t)},[s,r,m,g]),p=eE({mouse:n,drag:a,object:f,active:o,style:d,onChange:x,onClickAway:c}),h=(0,i.useMemo)(()=>null===p.object?null:(0,en.WC)({width:m,height:g},p.object,r),[m,g,r,p.object]);return{...p,geometry:h}}({drag:d,mouse:t,window:r,annotation:l,active:n,onChange:u,onEmptyClick:m,style:eS}),f=(0,i.useCallback)(e=>{if(!n)return;let{canvas:t}=e;g(e),s&&(t.style.cursor="copy")},[g,s,n]);return f}({mouse:c,ref:u,active:h.matches("edit.editing"),send:v,window:y.context.window,annotation:h.context.selectedAnnotation}),N=function(e){let{ref:t,mouse:n,annotations:a,window:r,active:l,send:o}=e,s=eA({mouse:n,annotations:a,window:r,active:l}),c=(0,i.useCallback)(()=>{l&&(null==s?o({type:"IDLE"}):o({type:"DELETE_ANNOTATION",annotation:s}))},[s,o,l]);eP({ref:t,onClick:c});let d=(0,i.useCallback)(e=>{if(!l||null==s)return;e.canvas.style.cursor="pointer";let t=(0,en.w9)({width:e.canvas.width,height:e.canvas.height},s.sound_event.geometry,r);(0,e_.Z)(e,t,eM)},[r,s,l]);return d}({ref:u,mouse:c,annotations:o,window:y.context.window,active:h.matches("delete.selecting"),send:v}),T=function(e){let{ref:t,mouse:n,annotations:a,window:r,send:l,active:o}=e,s=eA({mouse:n,annotations:a,window:r,active:o}),c=(0,i.useCallback)(()=>{o&&(null==s?l({type:"IDLE"}):l({type:"SELECT_ANNOTATION",annotation:s}))},[s,o,l]);eP({ref:t,onClick:c});let d=(0,i.useCallback)(e=>{if(!o||null==s)return;e.canvas.style.cursor="pointer";let t=(0,en.w9)({width:e.canvas.width,height:e.canvas.height},s.sound_event.geometry,r);(0,e_.Z)(e,t,eL)},[r,s,o]);return d}({ref:u,mouse:c,annotations:o,window:y.context.window,active:h.matches("edit.selecting"),send:v}),E=(0,eF.Z)({window:y.context.window,annotations:o}),Z=function(e){let{annotations:t,window:n,dimensions:a,send:r,active:l=!0}=e,o=(0,i.useMemo)(()=>t.filter(e=>(0,en.PT)(e.sound_event.geometry,n)),[t,n]),s=(0,i.useMemo)(()=>o.map(e=>{let t=function(e,t,n){let a=[t.time.min,t.freq.min,t.time.max,t.freq.max],r=(0,en.fM)(e.sound_event.geometry),l=(0,en.c0)(r,a);if(null===l)throw Error("Annotation is not in the window");let i=(0,en.$y)(n,l,t);return i[2]>n.width-50?{x:i[0],y:i[3],offset:5,placement:"left"}:{x:i[2],y:i[1],offset:5,placement:"right"}}(e,n,a),i=e.tags.map(t=>({tag:t,onClick:()=>r({type:"REMOVE_TAG",annotation:e,tag:t})}));return{tags:i,onAdd:t=>r({type:"ADD_TAG",annotation:e,tag:t}),position:t,annotation:e,active:l}}),[o,r,n,a,l]);return s}({annotations:o,window:y.context.window,active:h.matches("idle"),dimensions:{width:null!==(a=null===(t=u.current)||void 0===t?void 0:t.width)&&void 0!==a?a:0,height:null!==(r=null===(n=u.current)||void 0===n?void 0:n.height)&&void 0!==r?r:0},send:v}),S=(0,i.useCallback)(e=>{w(e),E(e),j(e),N(e),T(e),k(e)},[w,j,E,k,N,T]);return{state:h,send:v,draw:S,tags:Z}}({task:t,annotations:n,parameters:r,scratchState:f,mouseState:x,ref:g,onAddTag:s,onRemoveTag:c,onCreateAnnotation:d,onUpdateAnnotationGeometry:u,onDeleteAnnotation:m}),[b,w]=(0,C.L)(p.context.spectrogram);if(null==b.context.audio)throw Error("Audio is not initialized");!function(e){let{parameters:t}=e,n=(0,o.Z)(e=>e.setSpectrogramSettings);(0,T.Z)(()=>{n(t)},200,[t])}({parameters:b.context.parameters});let[j,k]=(0,C.L)(b.context.audio),N=(0,i.useCallback)(e=>{h({type:"IDLE"}),w("PAN"),w({type:"PAN_TO",window:e})},[w,h]),D=(0,i.useCallback)((e,t)=>{w({type:"SHIFT_WINDOW",shiftBy:e,relative:t})},[w]);return(0,eB.Z)({ref:g,draw:v}),(0,l.jsxs)(E.Z,{children:[(0,l.jsxs)("div",{className:"flex flex-row gap-8",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,l.jsx)(A.Z,{isDragging:p.matches("idle")&&b.matches("panning"),isZooming:p.matches("idle")&&b.matches("zooming"),onDrag:()=>{h({type:"IDLE"}),w("PAN")},onZoom:()=>{h({type:"IDLE"}),w("ZOOM")},onReset:()=>{h({type:"IDLE"}),w("RESET")}}),(0,l.jsx)(_.Z,{settings:b.context.parameters,onChange:(e,t)=>w({type:"SET_PARAMETER",key:e,value:t}),onClear:e=>w({type:"CLEAR_PARAMETER",key:e})})]}),(0,l.jsx)(H,{isDrawing:p.matches("create"),isDeleting:p.matches("delete"),isSelecting:p.matches("edit.selecting"),isEditing:p.matches("edit.editing"),geometryType:p.context.geometryType,onDraw:()=>h({type:"DRAW"}),onDelete:()=>h({type:"DELETE"}),onSelect:()=>h({type:"SELECT"}),onSelectGeometryType:e=>h({type:"SELECT_GEOMETRY_TYPE",geometryType:e})}),(0,l.jsx)(Z.Z,{samplerate:a.samplerate,currentTime:j.context.currentTime,startTime:j.context.startTime,endTime:j.context.endTime,speed:j.context.speed,loop:j.context.loop,playing:p.matches("idle")&&b.matches("playing"),play:()=>{h({type:"IDLE"}),w("PLAY")},pause:()=>{w("PAUSE"),h({type:"IDLE"})},seek:e=>k({type:"SEEK",time:e}),setSpeed:e=>k({type:"SET_SPEED",speed:e}),toggleLoop:()=>k({type:"TOGGLE_LOOP"})})]}),(0,l.jsx)("div",{className:"h-96",children:(0,l.jsx)(O,{tags:y,filter:{project__eq:t.project_id},onCreate:e=>{eR.Z.annotation_projects.addTag(t.project_id,e.id)},children:(0,l.jsx)("canvas",{ref:g,className:"w-full h-full"})})}),(0,l.jsx)(S.Z,{window:b.context.window,bounds:b.context.bounds,setWindow:N,shiftWindow:D})]})}var eW=n(70565),ez=n(24070);function eH(e){let{tags:t,project:n,onClick:a,onAddTag:r,onRemoveTag:s,onClearTags:c}=e,d=(0,o.Z)(e=>e.getTagColor),u=(0,i.useMemo)(()=>({project__eq:n.id}),[n.id]);return(0,l.jsxs)(E.Z,{children:[(0,l.jsx)(ez.H3,{className:"text-center",children:(0,l.jsx)(p.Z,{tooltip:(0,l.jsx)("div",{className:"w-48 text-center",children:"The tags selected here will be automatically attached to newly created annotations."}),placement:"top",children:(0,l.jsx)("span",{className:"cursor-help",children:"Current Tags"})})}),(0,l.jsxs)("div",{className:"flex flex-row w-full gap-1",children:[(0,l.jsx)(p.Z,{tooltip:"Clear tags",placement:"top",children:(0,l.jsx)(g.Z,{onClick:c,mode:"text",variant:"danger",children:(0,l.jsx)(f.pJ,{className:"h-5 w-5"})})}),(0,l.jsx)("div",{className:"grow",children:(0,l.jsx)(F.Z,{onSelect:r,onCreate:r,initialFilter:u,placeholder:"Add tags..."})})]}),(0,l.jsx)("div",{className:"flex flex-row flex-wrap gap-1",children:t.map(e=>(0,l.jsx)(eW.ZP,{tag:e,...d(e),onClick:()=>null==a?void 0:a(e),onClose:()=>null==s?void 0:s(e)},e.id))})]})}let eG={assigned:f.tB,completed:f.nQ,verified:f.SA,rejected:f.wv},eQ={assigned:"bg-blue-100 border-blue-200 text-blue-500",completed:"bg-emerald-100 border-emerald-200 text-emerald-500",verified:"bg-amber-100 border-amber-200 text-amber-500",rejected:"bg-red-100 border-red-200 text-red-500"};function eY(e){let{badge:t,onClick:n,onRemove:a}=e,{state:r}=t,i=eG[r],o=eQ[r];return(0,l.jsxs)("div",{className:L()(o,"flex flex-row items-center rounded-full border max-w-fit p-1"),children:[(0,l.jsxs)("button",{type:"button",className:"group focus:outline-none focus:ring-4 focus:ring-emerald-500/50 rounded-md",disabled:null==n,onClick:n,children:[(0,l.jsx)(i,{className:L()("transition-all w-6 h-6 inline-block",null!=n&&"group-hover:stroke-3")}),(0,l.jsx)("span",{className:L()("transition-all text-stone-500 text-sm font-thin ml-1",null!=n&&"group-hover:font-medium"),children:t.user.username})]}),null!=a&&(0,l.jsx)("button",{type:"button",className:"ml-1 group focus:outline-none focus:ring-4 focus:ring-emerald-500/50 rounded-md",onClick:a,children:(0,l.jsx)(f.Tw,{className:"transition-all w-4 h-4 group-hover:stroke-3"})})]})}function eK(e){let{task:t,done:n,review:a,verify:r,removeBadge:i}=e;return(0,l.jsxs)(E.Z,{children:[(0,l.jsx)(ez.H3,{className:"text-center",children:"Task Status"}),(0,l.jsx)("div",{className:"flex flex-row flex-wrap gap-2",children:null==t?(0,l.jsx)(w.Z,{}):t.status_badges.map(e=>(0,l.jsx)(eY,{badge:e,onRemove:()=>null==i?void 0:i(e)},e.id))}),(0,l.jsxs)("div",{className:"flex flex-row justify-center gap-2",children:[(0,l.jsx)(p.Z,{tooltip:"Task Done!",placement:"bottom",children:(0,l.jsx)(g.Z,{mode:"text",variant:"primary",onClick:n,children:(0,l.jsx)(f.nQ,{className:"w-6 h-6"})})}),(0,l.jsx)(p.Z,{tooltip:"Needs review",placement:"bottom",children:(0,l.jsx)(g.Z,{mode:"text",variant:"danger",onClick:a,children:(0,l.jsx)(f.Tw,{className:"w-6 h-6"})})}),(0,l.jsx)(p.Z,{tooltip:"Verified",placement:"bottom",children:(0,l.jsx)(g.Z,{mode:"text",variant:"warning",onClick:r,children:(0,l.jsx)(f.SA,{className:"w-6 h-6"})})})]})]})}function eV(e){let{tags:t,onRemoveTag:n,onAddTag:a,onClearTags:r}=e,i=(0,o.Z)(e=>e.getTagColor);return(0,l.jsxs)(E.Z,{children:[(0,l.jsx)(ez.H3,{className:"text-center",children:"Clip Tags"}),(0,l.jsxs)("div",{className:"flex flex-row flex-wrap items-center gap-2 text-stone-500",children:[0===t.length&&(0,l.jsx)("span",{className:"inline-block text-sm",children:"No tags..."}),t.map(e=>(0,l.jsx)(eW.ZP,{tag:e.tag,...i(e.tag),onClose:()=>null==n?void 0:n(e)},e.id)),(0,l.jsx)("div",{className:"inline-block",children:(0,l.jsx)(q,{onAdd:a,onCreate:e=>{null==a||a(e)}})}),t.length>0&&(0,l.jsx)(g.Z,{mode:"text",variant:"danger",padding:"p-1",onClick:r,children:(0,l.jsx)(f.pJ,{className:"h-5 w-5"})})]})]})}var eX=n(30646),eJ=n(72007),eU=n(62976),e$=n(17808);function e0(e){var t,n,a,r;let{task_id:o,project:s,tags:c,parameters:d,addTag:u,removeTag:m,clearTags:g,refresh:f}=e,x=(0,i.useCallback)(e=>{switch(e){case"completed":j.ZP.success("Task completed!");break;case"rejected":j.ZP.success("Task marked for review.");break;case"verified":j.ZP.success("Task verified.")}null==f||f()},[f]),p=function(e){var t;let{task_id:n,onDelete:a,onAddTag:r,onAddNote:l,onRemoveTag:o,onAddBadge:s,onRemoveBadge:c}=e,d=(0,eX.NL)(),u=(0,eJ.a)(["task",n],()=>eR.Z.tasks.get(n),{refetchOnWindowFocus:!1}),m=(0,eU.D)({mutationFn:async e=>await eR.Z.tasks.addTag({task_id:n,tag_id:e.id}),onSuccess:(e,t)=>{d.setQueryData(["task",n],e),null==r||r(t)}}),g=(0,eU.D)({mutationFn:async e=>await eR.Z.tasks.removeTag({task_id:n,tag_id:e.id}),onSuccess:(e,t)=>{d.setQueryData(["task",n],e),null==o||o(t.tag)}}),f=(0,eU.D)({mutationFn:async e=>await eR.Z.tasks.addNote({task_id:n,...e}),onSuccess:(e,t)=>{d.setQueryData(["task",n],e);let a=e.notes.find(e=>e.message===t.message);null!=a&&(null==l||l(a))}}),x=(0,eU.D)({mutationFn:async e=>{let{note_id:t,data:a}=e;return await eR.Z.tasks.updateNote({task_id:n,note_id:t,data:a})},onSuccess:e=>{d.setQueryData(["task",n],e)}}),p=(0,eU.D)({mutationFn:async e=>await eR.Z.tasks.removeNote({task_id:n,note_id:e}),onSuccess:e=>d.setQueryData(["task",n],e)}),h=(0,eU.D)({mutationFn:async()=>await eR.Z.tasks.delete(n),onSuccess:()=>{d.invalidateQueries(["task",n]),null==a||a()}}),v=(0,eU.D)({mutationFn:e=>eR.Z.tasks.addBadge({task_id:n,state:e}),onSuccess:(e,t)=>{d.setQueryData(["task",n],e),null==s||s(t)}}),y=(0,eU.D)({mutationFn:e=>eR.Z.tasks.removeBadge(n,e.id),onSuccess:(e,t)=>{d.setQueryData(["task",n],e),null==c||c(t)}}),b=(0,i.useCallback)(async()=>{var e,t;for(let n of null!==(t=null===(e=u.data)||void 0===e?void 0:e.tags)&&void 0!==t?t:[])await g.mutateAsync(n)},[null===(t=u.data)||void 0===t?void 0:t.tags,g]);return{query:u,addTag:m,removeTag:g,addNote:f,removeNote:p,updateNote:x,addBadge:v,removeBadge:y,delete:h,clearTags:b}}({task_id:o,onAddBadge:x}),h=(0,i.useMemo)(()=>({task__eq:o}),[o]),v=(0,e$.Z)({filter:h}),{mutateAsync:y}=v.addTag,b=(0,i.useCallback)(async(e,t)=>await j.ZP.promise(y({annotation_id:e.id,tag_id:t.id}),{loading:"Adding tag...",success:"Tag added!",error:"Failed to add tag."}),[y]),{mutateAsync:C}=v.removeTag,T=(0,i.useCallback)(async(e,t)=>await j.ZP.promise(C({annotation_id:e.id,tag_id:t.id}),{loading:"Removing tag...",success:"Tag removed!",error:"Failed to remove tag."}),[C]),{mutateAsync:E}=v.create,Z=(0,i.useCallback)(async(e,t,n)=>(null==n&&(n=c.map(e=>e.id)),await j.ZP.promise(E({task_id:e.id,geometry:t,tag_ids:n}),{loading:"Creating annotation...",success:"Annotation created!",error:"Failed to create annotation."})),[E,c]),{mutateAsync:S}=v.update,A=(0,i.useCallback)(async(e,t)=>await j.ZP.promise(S({annotation_id:e.id,data:{geometry:t}}),{loading:"Updating annotation...",success:"Annotation updated!",error:"Failed to update annotation."}),[S]),{mutateAsync:_}=v.delete,D=(0,i.useCallback)(async e=>await j.ZP.promise(_(e.id),{loading:"Deleting annotation...",success:"Annotation deleted!",error:"Failed to delete annotation."}),[_]);return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[(0,l.jsx)("div",{children:p.query.isLoading||null==p.query.data?(0,l.jsx)(w.Z,{}):(0,l.jsx)(k.Z,{recording:p.query.data.clip.recording})}),(0,l.jsx)("div",{className:"grow",children:(0,l.jsx)(N.Z,{tags:null!==(a=null===(t=p.query.data)||void 0===t?void 0:t.clip.recording.tags)&&void 0!==a?a:[],label:"Recording Tags",onClick:e=>u(e)})})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,l.jsx)("div",{className:"grow flex flex-col gap-3",children:p.query.isLoading||null==p.query.data?(0,l.jsx)(w.Z,{}):(0,l.jsx)(eO,{task:p.query.data,annotations:v.items,recording:p.query.data.clip.recording,parameters:d,onAddTag:b,onRemoveTag:T,onCreateAnnotation:Z,onUpdateAnnotationGeometry:A,onDeleteAnnotation:D})}),(0,l.jsxs)("div",{className:"max-w-sm flex flex-col gap-3",children:[(0,l.jsx)(eK,{task:p.query.data,done:()=>p.addBadge.mutate("completed"),review:()=>p.addBadge.mutate("rejected"),verify:()=>p.addBadge.mutate("verified"),removeBadge:e=>p.removeBadge.mutate(e)}),(0,l.jsx)(eH,{tags:c,project:s,onClick:p.addTag.mutate,onAddTag:u,onRemoveTag:m,onClearTags:g}),(0,l.jsx)(eV,{tags:null!==(r=null===(n=p.query.data)||void 0===n?void 0:n.tags)&&void 0!==r?r:[],onAddTag:p.addTag.mutate,onRemoveTag:p.removeTag.mutate})]})]})]})}var e1=n(95754);function e5(){let e=(0,i.useContext)(e1.Sr),t=(0,o.Z)(e=>e.spectrogramSettings),[n,a]=(0,i.useState)([]),{isLoading:r,filter:d,total:u,complete:m,pending:g,refresh:x,current:p,next:h,previous:v}=function(e){let{project:t}=e,[n,a]=(0,i.useState)(0),r=(0,i.useMemo)(()=>({project__eq:t.id}),[t.id]),l=(0,i.useMemo)(()=>({project__eq:t.id,pending__eq:!0}),[t.id]),{items:o,filter:c,pagination:d,query:{refetch:u,isLoading:m}}=(0,s.Z)({pageSize:10,filter:l}),{pendingFilter:g,completeFilter:f}=(0,i.useMemo)(()=>{let e={...c.filter,pending__eq:!0},t={...c.filter,pending__eq:!1};return{pendingFilter:e,completeFilter:t}},[c.filter]),{total:x,query:{refetch:p}}=(0,s.Z)({pageSize:0,filter:r}),{total:h,query:{refetch:v}}=(0,s.Z)({pageSize:0,filter:g}),{total:y,query:{refetch:b}}=(0,s.Z)({pageSize:0,filter:f}),w=(0,i.useCallback)(()=>{u(),v(),b(),p()},[u,v,b,p]),{nextPage:j,prevPage:k}=d,N=(0,i.useCallback)(()=>{a(e=>e+1>=o.length?(j(),0):e+1)},[o.length,j]),C=(0,i.useCallback)(()=>{a(e=>e-1<0?(k(),o.length-1):e-1)},[o.length,k]);return{tasks:o,pending:h,complete:y,total:x,filter:c,isLoading:m,current:o[n],refresh:w,next:N,previous:C}}({project:e}),[j]=function(e,t,n,a){let r=(0,c.usePathname)(),l=(0,c.useSearchParams)(),o=l.get(t),[s,d]=(0,i.useState)(o?a(o):e),u=(0,i.useCallback)(e=>{let a=new URLSearchParams(l);null==e?a.delete(t):a.set(t,n(e));let i=new URL(r,window.location.origin);i.search=a.toString(),window.history.replaceState({[t]:e},"",i),d(e)},[t,l,r,n]);return(0,i.useEffect)(()=>{o&&d(a(o))},[o,d,a]),(0,i.useEffect)(()=>{null!=e&&u(e)},[e,u]),[s,u]}(null==p?void 0:p.id,"task_id",e=>e.toString(),e=>parseInt(e,10)),k=(0,i.useCallback)(t=>{e.tags.includes(t)||eR.Z.annotation_projects.addTag(e.id,t.id),a(e=>e.includes(t)?e:[...e,t])},[a,e.id,e.tags]),N=(0,i.useCallback)(e=>{a(t=>t.filter(t=>t.id!==e.id))},[a]),C=(0,i.useCallback)(()=>{a([])},[a]);return r||null==j?(0,l.jsx)(w.Z,{}):0===u?(0,l.jsx)(b.Z,{children:"No task available. Please add more tasks to this project to continue annotating."}):(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)(y,{complete:m,filter:d,pending:g,next:h,previous:v}),null==p?(0,l.jsxs)(b.Z,{children:[(0,l.jsx)("div",{children:(0,l.jsx)(f.cV,{className:"h-16 w-16 text-green-500"})}),(0,l.jsx)("p",{className:"text-lg font-medium",children:"Congratulations!"}),(0,l.jsxs)("p",{children:["You have completed all tasks in this project"," ",d.size>0?"with the current filter settings. ":"","Add additional tasks",d.size>0?", or change the filter settings, ":"","to continue annotating."]})]}):(0,l.jsx)(e0,{parameters:t,task_id:j,project:e,refresh:x,tags:n,addTag:k,removeTag:N,clearTags:C})]})}},95754:function(e,t,n){"use strict";n.d(t,{GT:function(){return i},M8:function(){return c},Sr:function(){return o},St:function(){return l},vZ:function(){return s}});var a=n(6439),r=n(1799);let l=(0,a.createContext)({user:{id:"null",username:"anonymous",email:"",name:"anonymous",is_active:!1,is_superuser:!1}}),i=(0,a.createContext)({recording_id:-1}),o=(0,a.createContext)({id:-1,name:"",description:"",tags:[],created_at:new Date,uuid:""}),s=(0,a.createContext)({dataset:null,isLoading:!0}),c=(0,a.createContext)({evaluationSet:{id:-1,name:"",description:"",tags:[],uuid:"",mode:r.kU.CLIP_CLASSIFICATION,created_at:new Date}})},91293:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(14357),r=n(36973);function l(){return(0,a.jsx)("div",{className:"w-full h-full flex flex-row justify-center items-center",children:(0,a.jsx)(r.Z,{})})}},40072:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(14357),r=n(5374),l=n.n(r);function i(e){let{children:t,className:n,...r}=e;return(0,a.jsx)("div",{className:l()("border shadow flex flex-col gap-3 p-4 rounded-md border-stone-300 dark:border-stone-700 text-stone-700 dark:text-stone-300",n),...r,children:t})}},8554:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(14357);function r(e){let{children:t}=e;return(0,a.jsx)("div",{className:"p-8 w-full",children:(0,a.jsx)("div",{className:"w-full border border-dashed rounded-md border-stone-500 p-4 flex flex-col items-center justify-center text-stone-500 text-center",children:t})})}},38425:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var a=n(14357),r=n(56793);let l={eq:"=",ne:"≠",gt:">",lt:"<",ge:"≥",le:"≤"};function i(e){let{field:t,value:n,onRemove:i}=e,[o,s]=t.split("__");return s in l&&(s=l[s]),"boolean"==typeof n&&(n=n?"yes":"no"),"number"==typeof n&&(n=n.toLocaleString()),(0,a.jsxs)("span",{className:"inline-flex items-center whitespace-nowrap rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-600 ring-1 ring-inset ring-blue-500/10",children:[(0,a.jsxs)("span",{className:"align-middle h-full",children:[o," ",s," ",n]}),(0,a.jsx)("button",{className:"ml-1 hover:bg-blue-200 rounded p-1",onClick:()=>{null==i||i()},children:(0,a.jsx)(r.Tw,{className:"h-3 w-3"})})]})}function o(e){let{filter:t,total:n,showIfEmpty:l=!1,withLabel:o=!0}=e,s=Object.keys(t.filter).filter(e=>!t.isFixed(e)).length;return 0!==s||l?(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[null!=n&&(0,a.jsxs)("span",{className:"mr-3 text-stone-500",children:[n," results"]}),(0,a.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[o&&(0,a.jsxs)("span",{className:"mr-2 text-blue-200",children:[(0,a.jsx)(r.k1,{className:"inline-block h-5 w-5 mr-1"}),"filters:"]}),Object.entries(t.filter).filter(e=>{let[n,a]=e;return!t.isFixed(n)}).map(e=>{let[n,r]=e;return(0,a.jsx)(i,{field:n,value:r,onRemove:()=>t.clear(n)},n)})]})]}):null}},68840:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var a=n(14357),r=n(6439),l=n(29554),i=n(37301),o=n(56793),s=n(28217),c=n(60169);function d(e){var t;let{filterDefs:n,onChange:r}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-2 text-stone-700 dark:text-stone-300 underline underline-offset-2 decoration-amber-500 decoration-2",children:"Apply Filter"}),(0,a.jsx)(s.Z,{options:n,static:!1,renderOption:e=>(0,a.jsxs)(a.Fragment,{children:[null!==(t=e.icon)&&void 0!==t?t:e.icon,e.name]}),limit:5,fields:["name","prefix"],getOptionKey:e=>e.name,onSelect:r,autoFocus:!0})]})}function u(e){let{filter:t,filterDefs:n}=e,[l,i]=(0,r.useState)(null);return null==l?(0,a.jsx)(d,{filterDefs:n,onChange:e=>i(e)}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-2 flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-stone-500 mr-2",children:"Filter by"}),(0,a.jsx)("span",{className:"text-stone-700 dark:text-stone-300 underline underline-offset-2 decoration-amber-500 decoration-2",children:l.name})]}),(0,a.jsx)(c.Z,{mode:"text",variant:"warning",onClick:()=>i(null),children:(0,a.jsx)(o.xC,{className:"w-5 h-5 group-hover:stroke-3"})})]}),null!=l.description?(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("span",{className:"text-sm dark:text-stone-400 text-stone-600",children:l.description})}):null,(0,a.jsx)("div",{className:"flex flex-row space-x-2",children:l.selector({setFilter:e=>{let{name:n,value:a}=e;t.set(n,a),i(null)}})})]})}function m(e){let{filter:t,filterDefs:n,button:r,mode:s="filled",variant:d="primary",className:m}=e;return null==m&&(m=(0,c.y)({mode:s,variant:d})),(0,a.jsx)(i.J,{as:"div",className:"relative inline-block text-left",children:(0,a.jsxs)(l.bv,{placement:"bottom",flip:!0,portal:!0,offset:4,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:[(0,a.jsx)(i.J.Button,{className:m,children:null!=r?r:(0,a.jsx)(o.k1,{className:"h-4 w-4 stroke-2"})}),(0,a.jsx)(i.J.Panel,{unmount:!0,className:"w-96 divide-y divide-stone-100 rounded-md bg-stone-50 dark:bg-stone-700 border border-stone-200 dark:border-stone-500 shadow-md dark:shadow-stone-800 ring-1 ring-stone-900 ring-opacity-5 focus:outline-none z-50",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(u,{filter:t,filterDefs:n})})})]})})}},47044:function(e,t,n){"use strict";n.d(t,{D3:function(){return f},P9:function(){return u},f3:function(){return m},vN:function(){return g}});var a=n(14357),r=n(6439),l=n(60169),i=n(69708),o=n(70836),s=n(56793);function c(e){let{operation:t,onChangeOperation:n,value:r,name:l,onChangeValue:i,onSubmit:o}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:l,className:"block text-sm font-medium leading-6 text-gray-700 dark:text-stone-300 mb-2",children:l}),(0,a.jsxs)("div",{className:"relative rounded-md",children:[(0,a.jsxs)("div",{className:"absolute inset-y-0 left-0 flex items-center",children:[(0,a.jsx)("label",{htmlFor:"".concat(l,"-operation"),className:"sr-only",children:"Operation"}),(0,a.jsxs)("select",{className:"h-full rounded-l-md border-0 bg-transparent pl-2 pr-3 text-stone-500 focus:ring-2 focus:ring-inset focus:ring-emerald-600",id:"".concat(l,"-operation"),name:"".concat(l,"-operation"),value:t,onChange:e=>n(e.target.value),children:[(0,a.jsx)("option",{value:"gt",children:">"}),(0,a.jsx)("option",{value:"lt",children:"<"}),(0,a.jsx)("option",{value:"ge",children:"≥"}),(0,a.jsx)("option",{value:"le",children:"≤"})]})]}),(0,a.jsx)("input",{type:"number",id:l,name:l,className:"block w-full bg-stone-50 dark:bg-stone-900 rounded-md outline-none border-0 pl-14 pr-14 py-1 text-stone-900 dark:text-stone-300 ring-1 ring-inset ring-stone-300 dark:ring-stone-800 placeholder:text-stone-400 focus:ring-2 focus:ring-inset focus:ring-emerald-600 sm:text-sm sm:leading-6",value:r,onKeyDown:e=>{"Enter"===e.key&&o()},onChange:e=>i(parseFloat(e.target.value))}),(0,a.jsx)("button",{onClick:o,className:"absolute inline-block px-2 inset-y-0 right-0 rounded-r-md bg-emerald-300 text-emerald-700 dark:text-emerald-300 dark:bg-emerald-700 dark:hover:bg-emerald-800 dark:hover:text-emerald-400",children:"set"})]})]})}function d(e){let{name:t,value:n,onChange:r,onSubmit:l}=e;return(0,a.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,a.jsx)("label",{htmlFor:"".concat(t,"-isnull"),className:"text-sm font-medium text-stone-700 dark:text-stone-300",children:"Is null?"}),(0,a.jsx)(o.Z,{id:"".concat(t,"-isnull"),className:"form-checkbox rounded text-emerald-500 dark:text-emerald-500 shadow-sm focus:ring focus:ring-offset-0 focus:ring-emerald-300 focus:ring-opacity-50",checked:!0===n,indeterminate:!1===n,onChange:()=>{null===n?r(!1):!1===n?r(!0):r(null)}}),(0,a.jsx)("span",{className:"text-stone-500",children:null===n?"not set":n?"is null":"is not null"}),(0,a.jsx)("button",{onClick:l,disabled:null===n,className:"absolute px-2 py-1 right-0 rounded-md bg-emerald-300 text-emerald-700 dark:text-emerald-300 dark:bg-emerald-700 dark:hover:bg-emerald-800 dark:hover:text-emerald-400 disabled:bg-emerald-300 dark:disabled:bg-emerald-900 dark:disabled:text-emerald-600 disabled:text-emerald-600",children:"set"})]})}function u(e){let{setFilter:t,prefix:n="",name:l="field"}=e,[i,o]=(0,r.useState)(0),[s,d]=(0,r.useState)("gt");return(0,a.jsx)("div",{className:"flex flex-col w-full gap-2",children:(0,a.jsx)(c,{name:l,value:i,onChangeValue:o,operation:s,onChangeOperation:d,onSubmit:()=>{t({name:"".concat(n,"__").concat(s),value:i})}})})}function m(e){let{setFilter:t,prefix:n="",name:l="field"}=e,[i,o]=(0,r.useState)(0),[s,u]=(0,r.useState)("gt"),[m,g]=(0,r.useState)(null);return(0,a.jsxs)("div",{className:"relative flex flex-col w-full gap-4",children:[(0,a.jsx)(c,{name:l,value:i,onChangeValue:o,operation:s,onChangeOperation:u,onSubmit:()=>{t({name:"".concat(n,"__").concat(s),value:i})}}),(0,a.jsx)(d,{name:"is_null",value:m,onChange:g,onSubmit:()=>{t({name:"".concat(n,"__is_null"),value:m})}})]})}function g(e){let{setFilter:t,prefix:n=""}=e;return(0,a.jsxs)("div",{className:"flex flex-row justify-center w-full gap-2",children:[(0,a.jsxs)(l.Z,{mode:"text",variant:"primary",onClick:()=>{t({name:"".concat(n,"__eq"),value:!0})},children:[(0,a.jsx)(s.nQ,{className:"w-5 h-5 mr-1 group-hover:stroke-3"}),"Yes"]}),(0,a.jsxs)(l.Z,{mode:"text",variant:"danger",onClick:()=>{t({name:"".concat(n,"__eq"),value:!1})},children:[(0,a.jsx)(s.Tw,{className:"w-5 h-5 mr-1 group-hover:stroke-3"}),"No"]})]})}function f(e){let{setFilter:t,prefix:n=""}=e;return(0,a.jsx)("div",{className:"flex flex-col w-full gap-2",children:(0,a.jsx)(i.Z,{onSelect:e=>{t({name:"".concat(n,"__eq"),value:e.id})}})})}},24070:function(e,t,n){"use strict";n.d(t,{H1:function(){return i},H3:function(){return o},H4:function(){return s}});var a=n(14357),r=n(5374),l=n.n(r);function i(e){let{children:t,className:n,...r}=e;return(0,a.jsx)("h1",{className:l()("text-2xl font-bold text-stone-900 dark:text-stone-200",n),...r,children:t})}function o(e){let{children:t,className:n,...r}=e;return(0,a.jsx)("h3",{className:l()("text-lg font-semibold leading-7 items-center text-stone-900 dark:text-stone-200",n),...r,children:t})}function s(e){let{children:t,className:n,...r}=e;return(0,a.jsx)("h4",{className:l()("text-md font-semibold leading-6 text-stone-900 dark:text-stone-200",n),...r,children:t})}},9078:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(14357),r=n(5374),l=n.n(r);function i(e){let{total:t,complete:n,verified:r=0,error:i=0,className:o="mb-4"}=e,s=n/t*100,c=r/t*100,d=i/t*100,u=100-s-c-d;return(0,a.jsxs)("div",{className:l()(o,"w-full flex flex-row h-4 overflow-hidden bg-stone-200 rounded-full dark:bg-stone-700"),children:[(0,a.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-blue-600 dark:bg-blue-400 text-blue-100 dark:text-blue-900",style:{width:"".concat(u,"%")},children:u>=10?"".concat(u.toPrecision(3),"%"):""}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-red-600 dark:bg-red-400 text-red-100 dark:text-red-900",style:{width:"".concat(d,"%")},children:d>=10?"".concat(d.toPrecision(3),"%"):""}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-emerald-600 dark:bg-emerald-400 text-emerald-100 dark:text-emerald-500",style:{width:"".concat(s,"%")},children:s>=10?"".concat(s.toPrecision(3),"%"):""}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-amber-600 dark:bg-amber-400 text-amber-100 dark:text-amber-900",style:{width:"".concat(c,"%")},children:c>=10?"".concat(c.toPrecision(3),"%"):""})]})}},2915:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var a=n(14357),r=n(6439),l=n(85520),i=n(23076);function o(e){let{window:t,bounds:n,setWindow:o,shiftWindow:s,...c}=e,d=(0,r.useRef)(null),u=(0,r.useMemo)(()=>{var e,a;return function(e){let{width:t,height:n,window:a,bounds:r}=e;if(null==t||null==n)return{left:0,width:0,top:0,height:0};let l=(r.freq.max-a.freq.min)/(r.freq.max-r.freq.min),i=(r.freq.max-a.freq.max)/(r.freq.max-r.freq.min),o=(a.time.min-r.time.min)/(r.time.max-r.time.min),s=(a.time.max-r.time.min)/(r.time.max-r.time.min);return{top:Math.max(Math.min(Math.round(i*n),n),0),left:Math.max(Math.min(Math.round(o*t),t),0),height:Math.max(Math.min(Math.round((l-i)*n),n),0),width:Math.max(Math.min(Math.round((s-o)*t),t),0)}}({width:null===(e=d.current)||void 0===e?void 0:e.offsetWidth,height:null===(a=d.current)||void 0===a?void 0:a.offsetHeight,window:t,bounds:n})},[t,n]),m=(0,i.Z)({ref:d}),g=(0,r.useCallback)(e=>{let{window:t,offset:a}=e;if(null==d.current)return null;let{offsetWidth:r,offsetHeight:l}=d.current,{dx:i,dy:o,x:s,y:c}=a;if(null==i||null==o||null==r||null==l||null==s||null==c)return null;let{min:u,max:m}=n.time,{min:g,max:f}=n.freq,x=(m-u)*i/r,p=(f-g)*o/l,h=u+(m-u)*s/r,v=g+(f-g)*(l-c)/l,y=t.time.max-t.time.min,b=t.freq.max-t.freq.min;return{time:{min:h-y/2+x,max:h+y/2+x},freq:{min:v-b/2-p,max:v+b/2-p}}},[n]);return(0,l.Z)({window:t,setWindow:o,dragState:m,dragFunction:g}),(0,a.jsx)("div",{draggable:!1,className:"group select-none relative w-full flex flex-row items-center h-8 outline outline-1 rounded-md outline-stone-300 bg-stone-200 dark:bg-stone-800 dark:outline-stone-700 cursor-pointer",ref:d,...c,children:(0,a.jsx)("div",{draggable:!1,tabIndex:0,className:"absolute bg-emerald-300 dark:bg-emerald-700 rounded-md border border-emerald-500 group-hover:bg-emerald-500/80 hover:bg-emerald-500/80 cursor-pointer focus:ring-4 focus:ring-emerald-500/50 focus:outline-none",style:{...u}})})}},36973:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(14357),r=n(5374),l=n.n(r);function i(e){let{variant:t="primary",className:n="w-8 h-8"}=e;return(0,a.jsxs)("div",{role:"status",children:[(0,a.jsxs)("svg",{"aria-hidden":"true",className:l()(n,"mr-2 inline animate-spin text-stone-200 dark:text-stone-600",function(e){switch(e){case"primary":case"success":return"fill-emerald-500";case"secondary":return"fill-stone-900 dark:fill-stone-100";case"danger":return"fill-rose-500";case"warning":return"fill-yellow-500";case"info":return"fill-blue-500"}}(t)),viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})]})}},70836:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(14357),r=n(6439);function l(e){let{indeterminate:t,className:n="",...l}=e,i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{"boolean"==typeof t&&(i.current.indeterminate=!l.checked&&t)},[i,t,l.checked]),(0,a.jsx)("input",{type:"checkbox",ref:i,className:n+" cursor-pointer",...l})}},24957:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var a=n(14357),r=n(89462),l=n(56793),i=n(24070),o=n(57119);function s(e){let{children:t}=e;return(0,a.jsx)("div",{className:"flex flex-row iterms-center tracking-tighter",children:t})}function c(e){let{latitude:t,longitude:n}=e,r=null!=t&&null!=n;return(0,a.jsxs)(s,{children:[(0,a.jsx)(l._t,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),r?"".concat(t,", ").concat(n):(0,a.jsx)("span",{className:"dark:text-stone-600 text-stone-400 text-sm",children:"No location"})]})}function d(e){let{time:t}=e;return(0,a.jsxs)(s,{children:[(0,a.jsx)(l.wZ,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),null!=t?t:(0,a.jsx)("span",{className:"dark:text-stone-600 text-stone-400 text-sm",children:"No time"})]})}function u(e){let{date:t}=e;return(0,a.jsxs)(s,{children:[(0,a.jsx)(l.IH,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),null!=t?t.toLocaleDateString():(0,a.jsx)("span",{className:"dark:text-stone-600 text-stone-400 text-sm",children:"No date"})]})}function m(e){var t,n;let{recording:s}=e,{path:m}=s,g=(null!==(t=null===(n=m.split("\\").pop())||void 0===n?void 0:n.split("/").pop())&&void 0!==t?t:"").split(".").slice(0,-1).join(".");return(0,a.jsxs)("div",{className:"flex w-full flex-row items-center gap-x-6 overflow-x-scroll",children:[(0,a.jsxs)("div",{className:"inline-flex items-center",children:[(0,a.jsx)(l.He,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),(0,a.jsx)(i.H3,{className:"max-w-xl whitespace-nowrap",children:(0,a.jsx)(o.Z,{tooltip:(0,a.jsxs)("div",{className:"text-sm dark:bg-stone-700 dark:border-stone-800 w-96 whitespace-normal tracking-tighter break-all font-thin",children:[(0,a.jsx)("span",{className:"text-blue-500 font-normal",children:"Full path:"})," ",m]}),placement:"bottom",children:(0,a.jsxs)("button",{type:"button",className:"text-ellipsis overflow-hidden w-full",onClick:()=>{navigator.clipboard.writeText(m),r.ZP.success("Copied full path to clipboard")},children:[g,(0,a.jsx)("span",{className:"text-stone-500 text-sm",children:".WAV"})]})})})]}),(0,a.jsx)(c,{latitude:s.latitude,longitude:s.longitude}),(0,a.jsx)(d,{time:s.time}),(0,a.jsx)(u,{date:s.date})]})}},90185:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var a=n(14357),r=n(52315),l=n(56793),i=n(70565);function o(e){let{tags:t,label:n="Tags",onClick:o}=e,s=(0,r.Z)(e=>e.getTagColor);return(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsxs)("div",{className:"inline-flex",children:[(0,a.jsx)(l.lO,{className:"w-5 h-5 text-stone-500 inline-block mr-1"}),(0,a.jsxs)("span",{className:"text-stone-400 dark:text-stone-600 text-sm",children:[n,":"]})]}),(0,a.jsx)("div",{className:"flex flex-row flex-wrap gap-2",children:t.map(e=>(0,a.jsx)(i.ZP,{tag:e,...s(e),onClick:()=>null==o?void 0:o(e)},e.id))})]})}},55290:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(17010);let r={fillColor:"red",fillAlpha:1,radius:4};function l(e,t){var n,a,l,i;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;if((null!==(n=o.fillAlpha)&&void 0!==n?n:1)!==0){let{coordinates:n}=t,[r,s]=n;e.fillStyle=null!==(a=o.fillColor)&&void 0!==a?a:"red",e.globalAlpha=null!==(l=o.fillAlpha)&&void 0!==l?l:1,e.beginPath(),e.arc(r,s,null!==(i=o.radius)&&void 0!==i?i:4,0,2*Math.PI,!0),e.fill()}}var i=n(82943),o=n(28775),s=n(12148),c=n(22794);function d(e,t,n){let{type:d}=t;switch(d){case"TimeStamp":(0,o.Z)(e,t.coordinates,n);break;case"TimeInterval":let[u,m]=t.coordinates;(0,s.Z)(e,{min:u,max:m},n);break;case"BoundingBox":(0,c.Z)(e,t.coordinates,n);break;case"Point":l(e,t,n);break;case"MultiPoint":!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,{coordinates:a}=t;a.forEach(t=>{l(e,{type:"Point",coordinates:t},n)})}(e,t,n);break;case"LineString":(0,a.s6)(e,t,n);break;case"MultiLineString":(0,a.F$)(e,t,n);break;case"Polygon":(0,i.is)(e,t,n);break;case"MultiPolygon":(0,i.$W)(e,t,n);break;default:console.error("Cannot draw unknown geometry type ".concat(d))}}},12148:function(e,t,n){"use strict";n.d(t,{X:function(){return r},Z:function(){return l}});var a=n(30291);let r={fillColor:"red",fillAlpha:.5,borderWidth:1,borderAlpha:1};function l(e,t){var n,l;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,{canvas:o}=e,{height:s}=o,{min:c,max:d}=t;(null!==(n=i.borderAlpha)&&void 0!==n?n:1)!==0&&((0,a.F6)(e,i),e.beginPath(),e.moveTo(c,0),e.lineTo(c,s),e.stroke(),e.beginPath(),e.moveTo(d,0),e.lineTo(d,s),e.stroke()),(null!==(l=i.fillAlpha)&&void 0!==l?l:.5)!==0&&((0,a.wi)(e,i),e.fillRect(c,0,d-c,s))}},17010:function(e,t,n){"use strict";n.d(t,{F$:function(){return i},s6:function(){return l}});var a=n(30291);let r={borderColor:"red",borderWidth:2,borderAlpha:1};function l(e,t){var n;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;if((null!==(n=l.borderAlpha)&&void 0!==n?n:1)!==0){let{coordinates:n}=t;if(n.length<2)return;(0,a.F6)(e,l),e.beginPath();let[r,i]=n[0];e.moveTo(r,i),n.slice(1).forEach(t=>{let[n,a]=t;e.lineTo(n,a)}),e.stroke()}}function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,{coordinates:a}=t;a.forEach(t=>{l(e,{type:"LineString",coordinates:t},n)})}},82943:function(e,t,n){"use strict";n.d(t,{$W:function(){return i},is:function(){return l}});let a={borderColor:"red",borderWidth:1,borderAlpha:1,fillAlpha:.5,fillColor:"red"};function r(e,t){if(t.length<2){console.error("Invalid linering. Needs at least two points");return}let[n,a]=t[0];e.moveTo(n,a),t.slice(1).forEach(t=>{let[n,a]=t;return e.lineTo(n,a)}),e.lineTo(n,a)}function l(e,t){var n,l,i,o,s,c;let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,{coordinates:u}=t;if(0===u.length){console.error("Polygon has no exterior ring");return}let m=u[0];if(m.length<2){console.error("Invalid exterior ring for polygon");return}let[g,f]=m[0];e.beginPath(),r(e,m),u.slice(1).forEach(t=>{if(t.length<2){console.error("Invalid interior ring for polygon");return}r(e,t),e.moveTo(g,f)}),e.closePath(),e.fillStyle=null!==(l=null!==(n=d.fillColor)&&void 0!==n?n:d.borderColor)&&void 0!==l?l:"red",e.globalAlpha=null!==(i=d.fillAlpha)&&void 0!==i?i:1,e.fill("evenodd"),e.strokeStyle=null!==(o=d.borderColor)&&void 0!==o?o:"red",e.lineWidth=null!==(s=d.borderWidth)&&void 0!==s?s:1,e.globalAlpha=null!==(c=d.borderAlpha)&&void 0!==c?c:1,d.borderDash&&e.setLineDash(d.borderDash),e.stroke()}function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,{coordinates:r}=t;r.forEach(t=>{l(e,{type:"Polygon",coordinates:t},n)})}},81063:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(6439),r=n(89837),l=n(55290),i=n(30291);let o={borderColor:i.Vb,fillColor:i.Vb,borderWidth:2,fillAlpha:.1};function s(e){let{window:t,annotations:n}=e,i=(0,a.useCallback)(e=>{for(let a of n){let n=(0,r.w9)({width:e.canvas.width,height:e.canvas.height},a.sound_event.geometry,t);(0,l.Z)(e,n,o)}},[t,n]);return i}},17808:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var a=n(30646),r=n(62976),l=n(81361),i=n(11441),o=n(54313);let s={};function c(){let{filter:e=s,pageSize:t=100,onCreate:n,onDelete:c,onUpdate:d,onAddTag:u,onRemoveTag:m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},g=(0,o.Z)({fixed:e}),f=(0,a.NL)(),{items:x,total:p,pagination:h,query:v,queryKey:y}=(0,i.Z)({name:"annotations",func:l.Z.annotations.getMany,pageSize:t,filter:g.filter}),b=(0,r.D)({mutationFn:e=>l.Z.annotations.create(e),onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,total:t.total+1,items:[e,...t.items]}),null==n||n(e)}}),w=(0,r.D)({mutationFn:e=>{let{annotation_id:t,data:n}=e;return l.Z.annotations.update(t,n)},onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.map(t=>t.id===e.id?e:t)}),null==d||d(e)}}),j=(0,r.D)({mutationFn:e=>l.Z.annotations.delete(e),onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.filter(t=>t.id!==e.id)}),null==c||c(e)}}),k=(0,r.D)({mutationFn:e=>{let{annotation_id:t,tag_id:n}=e;return l.Z.annotations.addTag(t,n)},onSuccess:e=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.map(t=>t.id===e.id?e:t)}),null==u||u(e)}}),N=(0,r.D)({mutationFn:e=>{let{annotation_id:t,tag_id:n}=e;return l.Z.annotations.removeTag(t,n)},onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.map(t=>t.id===e.id?e:t)}),null==m||m(e)}}),C=(0,r.D)({mutationFn:e=>{let{annotation_id:t,message:n,is_issue:a}=e;return l.Z.annotations.addNote(t,n,a)},onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.map(t=>t.id===e.id?e:t)}),null==d||d(e)}}),T=(0,r.D)({mutationFn:e=>{let{annotation_id:t,note_id:n}=e;return l.Z.annotations.removeNote(t,n)},onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.map(t=>t.id===e.id?e:t)}),null==d||d(e)}}),E=(0,r.D)({mutationFn:e=>{let{annotation_id:t,note_id:n,message:a,is_issue:r}=e;return l.Z.annotations.updateNote(t,n,a,r)},onSuccess:(e,t)=>{f.setQueryData(y,t=>null==t?t:{...t,items:t.items.map(t=>t.id===e.id?e:t)}),null==d||d(e)}});return{items:x,total:p,pagination:h,query:v,filter:g,create:b,update:w,delete:j,addTag:k,removeTag:N,addNote:C,removeNote:T,updateNote:E}}},29050:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var a=n(81361),r=n(11441),l=n(54313);let i={};function o(){let{filter:e=i,pageSize:t=10,enabled:n=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,l.Z)({fixed:e}),{query:s,pagination:c,items:d,total:u}=(0,r.Z)({name:"tasks",func:a.Z.tasks.getMany,pageSize:t,filter:o.filter,enabled:n});return{filter:o,query:s,pagination:c,items:d,total:u}}},32091:function(e,t,n){e.exports=n(2810)},84802:function(e,t,n){"use strict";var a=n(6439);let r=a.forwardRef(function({title:e,titleId:t,...n},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?a.createElement("title",{id:t},e):null,a.createElement("path",{fillRule:"evenodd",d:"M10 3a.75.75 0 01.55.24l3.25 3.5a.75.75 0 11-1.1 1.02L10 4.852 7.3 7.76a.75.75 0 01-1.1-1.02l3.25-3.5A.75.75 0 0110 3zm-3.76 9.2a.75.75 0 011.06.04l2.7 2.908 2.7-2.908a.75.75 0 111.1 1.02l-3.25 3.5a.75.75 0 01-1.1 0l-3.25-3.5a.75.75 0 01.04-1.06z",clipRule:"evenodd"}))});t.Z=r}},function(e){e.O(0,[6949,3372,4564,243,2007,1651,3683,9530,422,2172,8821,9077,1361,9803,8525,5980,8702,7431,1744],function(){return e(e.s=94137)}),_N_E=e.O()}]);