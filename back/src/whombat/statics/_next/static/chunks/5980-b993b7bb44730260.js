"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5980],{17526:function(e,n,t){t.d(n,{Z:function(){return f}});var l=t(14357),r=t(6439),i=t(29554),a=t(88067),o=t(5374),s=t.n(o),u=t(86525),c=t(56793);let d=[{id:"0.1",label:"0.1x",value:.1},{id:"0.2",label:"0.2x",value:.2},{id:"0.5",label:"0.5x",value:.5},{id:"0.8",label:"0.8x",value:.8},{id:"1",label:"1x",value:1},{id:"1.25",label:"1.25x",value:1.25},{id:"1.5",label:"1.5x",value:1.5},{id:"2",label:"2x",value:2},{id:"5",label:"5x",value:5},{id:"10",label:"10x",value:10}],m="focus:outline-none focus:ring-4 focus:ring-emerald-500/50 rounded-full";function f(e){let{samplerate:n,currentTime:t,startTime:i,endTime:a,speed:o,playing:f,loop:g,play:x,pause:v,seek:b,setSpeed:w,toggleLoop:y}=e,j=(0,r.useRef)(null),T=(0,r.useCallback)(e=>{let n=a-i,t=i+e*n;b(t)},[i,a,b]);(0,u.Z)(j,{onScrub:T});let k=(0,r.useMemo)(()=>{let e=a-i,n=(t-i)/e;return 100*n},[t,i,a]),S=(0,r.useMemo)(()=>d.filter(e=>e.value*n<=48e3),[n]);return(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2 border rounded-md border-stone-300 bg-stone-100 dark:border-stone-600 dark:bg-stone-700 px-2",children:[(0,l.jsx)("button",{type:"button",className:s()("text-stone-600 hover:text-stone-800 dark:text-stone-400 dark:hover:text-stone-200",m),onClick:()=>{if(f)return v();x()},children:f?(0,l.jsx)(c.fp,{className:"h-5 w-5"}):(0,l.jsx)(c.o1,{className:"h-5 w-5"})}),(0,l.jsx)("button",{type:"button",className:s()(m,{"text-emerald-500 dark:hover:text-emerald-300 hover:text-emerald-700":g,"dark:text-stone-400 dark:hover:text-stone-200 text-stone-600 hover:text-stone-800":!g}),onClick:()=>y(),children:(0,l.jsx)(c.Dj,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{className:"w-36 ml-2",children:[(0,l.jsxs)("div",{className:"flex justify-between text-xs text-stone-600 dark:text-stone-400",children:[(0,l.jsx)("p",{children:h(t)}),(0,l.jsx)("p",{children:h(a)})]}),(0,l.jsx)("div",{ref:j,className:"py-1 w-full cursor-pointer",children:(0,l.jsx)("div",{className:"relative h-1 bg-stone-900 rounded-full w-full",children:(0,l.jsx)("div",{className:"h-1 bg-emerald-600 dark:bg-emerald-200 rounded-full relative",style:{width:"".concat(Math.min(k,100),"%")},children:(0,l.jsx)("span",{tabIndex:0,className:"w-3 h-3 bg-emerald-500 absolute right-0 -mt-1 rounded-full shadow cursor-pointer focus:outline-none focus:ring-4 focus:ring-emerald-500/50"})})})})]}),(0,l.jsx)(p,{speed:o,onChange:e=>w(e),options:S})]})}function h(e){return void 0===e?"00:00.000":new Date(1e3*e).toISOString().substring(11,22).replace(/^00:/,"")}function p(e){let{speed:n,onChange:t,options:o}=e;return(0,l.jsx)(a.R,{value:n,onChange:t,children:(0,l.jsxs)(i.bv,{as:"div",className:"relative",leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",placement:"bottom",offset:4,flip:!0,floatingAs:r.Fragment,children:[(0,l.jsxs)(a.R.Button,{className:s()(m,"text-stone-600 hover:text-stone-800 dark:text-stone-400 dark:hover:text-stone-200","flex flex-row items-center w-full pr-7"),children:[(0,l.jsx)(c.rj,{className:"h-5 w-5"}),(0,l.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-1",children:(0,l.jsx)(c.Qq,{className:"h-5 w-5","aria-hidden":"true"})})]}),(0,l.jsx)(a.R.Options,{className:"max-h-60 w-full overflow-auto rounded-md bg-stone-50 dark:bg-stone-700 py-1 text-base shadow-lg ring-1 ring-stone-900 dark:ring-stone-600 ring-opacity-5 focus:outline-none sm:text-sm",children:o.map(e=>(0,l.jsx)(a.R.Option,{value:e.value,className:e=>{let{active:n}=e;return"relative cursor-default select-none p-1 ".concat(n?"bg-emerald-100 text-emerald-900":"text-stone-900 dark:text-stone-300")},children:n=>{let{selected:t}=n;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("span",{className:"block truncate ".concat(t?"text-emerald-500 font-medium":"font-normal"),children:e.label})})}},e.id))})]})})}},61425:function(e,n,t){t.d(n,{Z:function(){return u}});var l=t(14357),r=t(6439),i=t(29554),a=t(88067),o=t(56793),s=t(35573);function u(e){let{label:n,selected:t,onChange:u,options:c,placement:d="top-end"}=e;return(0,l.jsx)(a.R,{value:t.value,onChange:u,children:(0,l.jsxs)(i.bv,{as:"div",className:"relative",leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",placement:d,offset:4,flip:!0,floatingAs:r.Fragment,children:[(0,l.jsxs)(a.R.Button,{as:"div",className:"inline-flex gap-2 w-full",children:[n?(0,l.jsx)("div",{className:"my-auto inline-block",children:(0,l.jsx)(a.R.Label,{className:"text-sm text-stone-500 dark:text-stone-400 whitespace-nowrap",children:n})}):null,(0,l.jsxs)(s.k4,{className:"w-full cursor-default border pl-3 pr-10 text-left",children:[(0,l.jsx)("span",{className:"block truncate",children:t.label}),(0,l.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,l.jsx)(o.Qq,{className:"h-5 w-5 text-stone-400","aria-hidden":"true"})})]})]}),(0,l.jsx)(a.R.Options,{className:"max-h-60 w-full overflow-auto rounded-lg bg-stone-50 dark:bg-stone-700 py-1 text-base shadow-lg ring-1 ring-stone-900 dark:ring-stone-600 ring-opacity-5 focus:outline-none sm:text-sm",children:c.map(e=>(0,l.jsx)(a.R.Option,{value:e.value,className:e=>{let{active:n}=e;return"relative cursor-default select-none py-2 pl-10 pr-4 ".concat(n?"bg-amber-100 text-amber-900":"text-stone-900 dark:text-stone-400")},children:n=>{let{selected:t}=n;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"block truncate ".concat(t?"font-medium":"font-normal"),children:e.label}),t?(0,l.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-amber-600",children:(0,l.jsx)(o.nQ,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.id))})]})})}},99093:function(e,n,t){t.d(n,{Z:function(){return o}});var l=t(14357),r=t(60169),i=t(57119),a=t(56793);function o(e){let{isDragging:n,isZooming:t,onDrag:o,onZoom:s,onReset:u}=e;return(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(i.Z,{tooltip:"Reset view",placement:"bottom",children:(0,l.jsx)(r.Z,{variant:"secondary",onClick:u,children:(0,l.jsx)(a.tv,{className:"w-5 h-5"})})}),(0,l.jsx)(i.Z,{tooltip:"Drag spectrogram",placement:"bottom",children:(0,l.jsx)(r.Z,{variant:n?"primary":"secondary",onClick:o,children:(0,l.jsx)(a.Vn,{className:"w-5 h-5"})})}),(0,l.jsx)(i.Z,{tooltip:"Zoom to selection",placement:"bottom",children:(0,l.jsx)(r.Z,{variant:t?"primary":"secondary",onClick:s,children:(0,l.jsx)(a.An,{className:"w-5 h-5"})})})]})}},78877:function(e,n,t){t.d(n,{Z:function(){return Z}});var l=t(14357),r=t(6439),i=t(5374),a=t.n(i),o=t(3841),s=t(96489),u=t(60169),c=t(57119),d=t(61425),m=t(88821),f=t(80972),h=t(80998);function p(e){let{title:n,children:t,isOpen:i=!1,onClose:a}=e;return(0,l.jsx)(f.u.Root,{show:i,as:r.Fragment,children:(0,l.jsxs)(m.V,{as:"div",className:"relative z-10",onClose:()=>null==a?void 0:a(),children:[(0,l.jsx)(f.u.Child,{as:r.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 overflow-hidden",children:(0,l.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,l.jsx)("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,l.jsx)(f.u.Child,{as:r.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,l.jsxs)(m.V.Panel,{className:"pointer-events-auto relative w-screen max-w-md",children:[(0,l.jsx)(f.u.Child,{as:r.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"absolute left-0 top-0 -ml-8 flex pr-2 pt-4 sm:-ml-10 sm:pr-4",children:(0,l.jsxs)("button",{type:"button",className:"relative rounded-md text-red-400 hover:text-white focus:outline-none focus:ring-4 focus:ring-red-500/50",onClick:()=>null==a?void 0:a(),children:[(0,l.jsx)("span",{className:"absolute -inset-2.5"}),(0,l.jsx)("span",{className:"sr-only",children:"Close panel"}),(0,l.jsx)(h.Z,{className:"h-6 w-6","aria-hidden":"true"})]})})}),(0,l.jsxs)("div",{className:"flex h-full flex-col overflow-y-scroll bg-stone-100 dark:bg-stone-800 py-6 shadow-xl",children:[(0,l.jsx)("div",{className:"px-4 sm:px-6",children:(0,l.jsx)(m.V.Title,{className:"text-base font-semibold leading-6 text-stone-900 dark:text-stone-400",children:n})}),(0,l.jsx)("div",{className:"relative mt-6 flex-1 px-4 sm:px-6",children:t})]})]})})})})})]})})}var g=t(39371);function x(e){var n;let{value:t,defaultValue:r,name:i="range-slider",inverted:o,minLabel:s,maxLabel:u,...c}=e,d=null!==(n=null!=t?t:r)&&void 0!==n?n:[];return(0,l.jsxs)(g.fC,{className:"relative flex items-center w-64 h-2 mb-6",defaultValue:r,value:t,...c,children:[(0,l.jsx)(g.fQ,{className:a()("relative grow h-2 rounded-full",{"bg-emerald-500":o,"bg-stone-300 dark:bg-stone-800":!o}),children:(0,l.jsx)(g.e6,{className:a()("absolute h-full rounded-full",{"bg-emerald-500":!o,"bg-stone-300 dark:bg-stone-800":o})})}),d.map((e,n)=>(0,l.jsx)(g.bU,{className:"block w-4 h-4 bg-stone-200 border border-stone-400 rounded-full hover:bg-stone-50 focus:outline-none focus:ring-4 focus:ring-emerald-500/50"},"".concat(i,"-").concat(n))),null!=s&&(0,l.jsx)("div",{className:"absolute text-sm text-stone-800 dark:text-stone-500 -ml-1 bottom-0 left-0 -mb-6",children:s}),null!=u&&(0,l.jsx)("div",{className:"absolute text-sm text-stone-800 dark:text-stone-500 -mr-1 bottom-0 right-0 -mb-6",children:u})]})}var v=t(35573),b=t(56793),w=t(9797);let y={gray:{id:"gray",value:"gray",label:"Gray"},viridis:{id:"viridis",value:"viridis",label:"Viridis"},magma:{id:"magma",value:"magma",label:"Magma"},inferno:{id:"inferno",value:"inferno",label:"Inferno"},plasma:{id:"plasma",value:"plasma",label:"Plasma"},cividis:{id:"cividis",value:"cividis",label:"Cividis"},cool:{id:"cool",value:"cool",label:"Cool"},cubehelix:{id:"cubehelix",value:"cubehelix",label:"Cubehelix"},twilight:{id:"twilight",value:"twilight",label:"Twilight"}},j={hann:{id:"hann",value:"hann",label:"Hann"},hamming:{id:"hamming",value:"hamming",label:"Hamming"},boxcar:{id:"boxcar",value:"boxcar",label:"Boxcar"},triang:{id:"triang",value:"triang",label:"Triangular"},blackman:{id:"blackman",value:"blackman",label:"Blackman"},bartlett:{id:"bartlett",value:"bartlett",label:"Bartlett"},flattop:{id:"flattop",value:"flattop",label:"Flat top"},parzen:{id:"parzen",value:"parzen",label:"Parzen"},bohman:{id:"bohman",value:"bohman",label:"Bohman"},blackmanharris:{id:"blackmanharris",value:"blackmanharris",label:"Blackman-Harris"},nuttall:{id:"nuttall",value:"nuttall",label:"Nuttall"},barthann:{id:"barthann",value:"barthann",label:"Bartlett-Hann"}};function T(e){let{children:n}=e;return(0,l.jsx)("div",{className:"flex flex-col max-w-md w-full gap-2 border rounded-md p-4 dark:border-stone-600",children:n})}function k(e){var n,t;let{settings:r,onChange:i}=e;return(0,l.jsxs)(T,{children:[(0,l.jsx)(v.BZ,{name:"resample",label:"Resampling",help:r.resample?"Uncheck to disable resampling.":"Audio is not being resampled. Check to enable resampling.",children:(0,l.jsx)(s.Z,{label:"Resample",checked:null!==(n=r.resample)&&void 0!==n&&n,onChange:e=>null==i?void 0:i("resample",e)})}),r.resample&&(0,l.jsx)(v.BZ,{name:"resampleRate",label:"Target rate",help:"Select the sampling rate you want to resample to, in Hertz.",children:(0,l.jsx)(v.II,{type:"number",value:null!==(t=r.samplerate)&&void 0!==t?t:44100,onChange:e=>null==i?void 0:i("samplerate",parseInt(e.target.value))})})]})}function S(e){var n,t;let{settings:i,onChange:a}=e,o=(0,r.useMemo)(()=>{var e;return j[null!==(e=i.window)&&void 0!==e?e:"hann"]},[i.window]);return(0,l.jsxs)(T,{children:[(0,l.jsx)(v.BZ,{name:"windowSize",label:"Window size",help:"Select the size of the window used for the STFT, in seconds.",children:(0,l.jsx)(v.II,{type:"number",value:null!==(n=i.window_size)&&void 0!==n?n:.025,min:.001,step:.001,onChange:e=>null==a?void 0:a("window_size",parseFloat(e.target.value))})}),(0,l.jsx)(v.BZ,{name:"hopSize",label:"Hop size",help:"Select the size of the hop used for the STFT, in seconds.",children:(0,l.jsx)(v.II,{type:"number",value:null!==(t=i.hop_size)&&void 0!==t?t:.01,min:.001,step:.001,onChange:e=>null==a?void 0:a("hop_size",parseFloat(e.target.value))})}),(0,l.jsx)(v.BZ,{name:"window",label:"Window",help:"Select the window function to use for the STFT.",children:(0,l.jsx)(d.Z,{selected:o,onChange:e=>null==a?void 0:a("window",e),options:Object.values(j)})})]})}function C(e){var n;let{settings:t,onChange:i,onClear:s,nyquistFrequency:u}=e,c=null==t.low_freq&&null==t.high_freq?"":null!=t.low_freq&&null!=t.high_freq?"band":null!=t.low_freq?"low":null!=t.high_freq?"high":"",[d,m]=(0,r.useState)(c),f=(0,r.useMemo)(()=>{var e,n,r,a,o;let s=(t.resample&&null!==(e=t.samplerate)&&void 0!==e?e:u)/2;return"band"===d?(0,l.jsx)(x,{defaultValue:[null!==(n=t.low_freq)&&void 0!==n?n:1,null!==(r=t.high_freq)&&void 0!==r?r:.99*s],min:1,step:100,name:"band",max:.99*s,minStepsBetweenThumbs:5,minLabel:"0 Hz",maxLabel:"".concat(s.toLocaleString()," Hz"),onValueCommit:e=>{var n,t;null==i||i("low_freq",null!==(n=e[0])&&void 0!==n?n:1),null==i||i("high_freq",null!==(t=e[1])&&void 0!==t?t:.99*s)}},"band"):"high"===d?(0,l.jsx)(x,{defaultValue:[null!==(a=t.low_freq)&&void 0!==a?a:1],step:100,min:1,name:"high",max:.99*s,minLabel:"0 Hz",maxLabel:"".concat(s.toLocaleString()," Hz"),inverted:!0,onValueCommit:e=>{var n;null==i||i("low_freq",null!==(n=e[0])&&void 0!==n?n:1)}},"high"):"low"===d?(0,l.jsx)(x,{defaultValue:[null!==(o=t.high_freq)&&void 0!==o?o:.99*s],step:100,min:1,name:"low",minLabel:"0 Hz",maxLabel:"".concat(s.toLocaleString()," Hz"),max:.99*s,onValueCommit:e=>{var n;null==i||i("high_freq",null!==(n=e[0])&&void 0!==n?n:.99*s)}},"low"):null},[t,d,u,i]),h=[{value:"low",text:"Lowpass",label:"Low-pass filter"},{value:"high",text:"Highpass",label:"High-pass filter"},{value:"band",text:"Bandpass",label:"Band-pass filter"}],p=""===d?"No frequency filtering is being applied. Select a filter type to enable filtering.":"low"===d?"Click again to disable. Only frequencies below the selected value will be kept.":"high"===d?"Click again to disable. Only frequencies above the selected value will be kept.":"Click again to disable. Only frequencies between the selected values will be kept.";return(0,l.jsxs)(T,{children:[(0,l.jsx)(v.BZ,{name:"lowFreq",label:"Filtering",help:p,children:(0,l.jsx)(o.fC,{type:"single",className:"divide-x divide-stone-300 dark:divide-stone-600",value:d,onValueChange:e=>{""===e?(null==s||s("low_freq"),null==s||s("high_freq")):"low"===e?(null==s||s("low_freq"),null==t.high_freq&&(null==i||i("high_freq",.99*u))):"high"===e&&(null==s||s("high_freq"),null==t.low_freq&&(null==i||i("low_freq",1))),m(e)},"aria-label":"Filter type",children:h.map((e,n)=>{let{value:t,text:r,label:i}=e;return(0,l.jsx)(o.ck,{className:a()("p-1 px-2",{"rounded-s":0===n,"rounded-e":n===h.length-1,"bg-stone-200 dark:bg-stone-700 hover:bg-emerald-500":d!=t,"bg-emerald-700 text-emerald-300 dark:bg-emerald-300 dark:text-emerald-700 dark:hover:bg-emerald-400 hover:bg-emerald-800":d===t},"focus:outline-none focus-visible:ring-4 focus-visible:ring-emerald-500 focus-visible:ring-opacity-75"),value:t,"aria-label":i,children:r},t)})})}),f,""!=d&&(0,l.jsx)(v.BZ,{name:"order",label:"Order filter",help:"Select the order of butterworth filter to use",children:(0,l.jsx)(v.II,{type:"number",value:null!==(n=t.filter_order)&&void 0!==n?n:4,onChange:e=>null==i?void 0:i("filter_order",parseInt(e.target.value)),max:10,min:1})})]})}function N(e){let{settings:n,onChange:t}=e,i=(0,r.useMemo)(()=>{var e,t;return null!==(t=y[null!==(e=n.cmap)&&void 0!==e?e:"viridis"])&&void 0!==t?t:y.viridis},[n.cmap]);return(0,l.jsx)(T,{children:(0,l.jsx)(v.BZ,{name:"colorMap",label:"Color map",help:"Select the color map to use for the spectrogram.",children:(0,l.jsx)(d.Z,{selected:i,onChange:e=>null==t?void 0:t("cmap",e),options:Object.values(y)})})})}function M(e){var n,t,r;let{settings:i,onChange:a}=e;return(0,l.jsxs)(T,{children:[(0,l.jsx)(v.BZ,{name:"Clamp",label:"Clamp Amplitude",help:i.clamp?"Amplitude values are being clamped.\n          Uncheck to disable clamping.":"Amplitude values are not being clamped. \n          Check here to enable clamping.",children:(0,l.jsx)(s.Z,{label:"Clamp",checked:null!==(n=i.clamp)&&void 0!==n&&n,onChange:e=>null==a?void 0:a("clamp",e)})}),i.clamp&&(0,l.jsx)(v.BZ,{name:"clampValues",label:"Min and Max amplitude values",help:"Select the min and max amplitude values to clamp to.",children:(0,l.jsx)(x,{defaultValue:[null!==(t=i.min_dB)&&void 0!==t?t:w.$q,null!==(r=i.max_dB)&&void 0!==r?r:0],min:w.$q,max:0,step:1,minLabel:"".concat(w.$q," dB"),maxLabel:"0 dB",onValueCommit:e=>{null==a||a("min_dB",e[0]),null==a||a("max_dB",e[1])}})})]})}function E(e){var n;let{settings:t,onChange:r}=e;return(0,l.jsx)(T,{children:(0,l.jsx)(v.BZ,{name:"denoise",label:"De-noise",help:t.pcen?"De-noising is being applied. Uncheck to disable de-noising.":"Check to apply PCEN de-noising.",children:(0,l.jsx)(s.Z,{label:"De-noise",checked:null!==(n=t.pcen)&&void 0!==n&&n,onChange:e=>null==r?void 0:r("pcen",e)})})})}let q={dB:{id:"dB",value:"dB",label:"decibels (dB)"},amplitude:{id:"amplitude",value:"amplitude",label:"amplitude"},power:{id:"power",value:"power",label:"power"}};function _(e){var n;let{settings:t,onChange:i}=e,a=(0,r.useMemo)(()=>{var e;return q[null!==(e=t.scale)&&void 0!==e?e:"dB"]},[t.scale]);return(0,l.jsxs)(T,{children:[(0,l.jsx)(v.BZ,{name:"scale",label:"Amplitude Scale",help:"Select the amplitude scale to use for the spectrogram.",children:(0,l.jsx)(d.Z,{selected:a,onChange:e=>null==i?void 0:i("scale",e),options:Object.values(q)})}),(0,l.jsx)(v.BZ,{name:"normalize",label:"Normalize Amplitudes",help:"Toggle to normalize amplitude values.",children:(0,l.jsx)(s.Z,{label:"Normalize",checked:null!==(n=t.normalize)&&void 0!==n&&n,onChange:e=>null==i?void 0:i("normalize",e)})})]})}function A(e){let{settings:n,onChange:t,onClear:r,nyquistFrequency:i=44100}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(k,{settings:n,onChange:t}),(0,l.jsx)(C,{nyquistFrequency:i,settings:n,onChange:t,onClear:r}),(0,l.jsx)(S,{settings:n,onChange:t}),(0,l.jsx)(E,{settings:n,onChange:t}),(0,l.jsx)(N,{settings:n,onChange:t}),(0,l.jsx)(_,{settings:n,onChange:t}),(0,l.jsx)(M,{settings:n,onChange:t})]})}function Z(e){let{settings:n,onChange:t,onClear:i,nyquistFrequency:a=44100}=e,[o,s]=(0,r.useState)(!1);return(0,l.jsxs)("div",{children:[(0,l.jsx)(c.Z,{placement:"bottom",tooltip:"Spectrogram settings",children:(0,l.jsx)(u.Z,{variant:"secondary",onClick:()=>s(!0),children:(0,l.jsx)(b.ew,{className:"w-5 h-5"})})}),(0,l.jsx)(p,{title:(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)(b.ew,{className:"w-6 h-6 mr-2 inline-block"}),"Settings"]}),isOpen:o,onClose:()=>s(!1),children:(0,l.jsx)(A,{nyquistFrequency:a,settings:n,onChange:t,onClear:i})})]})}},96489:function(e,n,t){t.d(n,{Z:function(){return i}});var l=t(14357),r=t(11391);function i(e){let{checked:n,onChange:t,label:i="Toggle"}=e;return(0,l.jsxs)(r.r,{checked:n,onChange:t,className:"".concat(n?"bg-emerald-600 dark:bg-emerald-500":"bg-emerald-900 dark:bg-emerald-800","\n          relative inline-flex h-5 w-12 shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-4 focus:ring-emerald-500/50 focus-visible:ring-4 focus-visible:ring-emeral-500/50"),children:[(0,l.jsx)("span",{className:"sr-only",children:i}),(0,l.jsx)("span",{"aria-hidden":"true",className:"".concat(n?"translate-x-7":"translate-x-0","\n            pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow-lg ring-0 transition duration-200 ease-in-out")})]})}},57119:function(e,n,t){t.d(n,{Z:function(){return s}});var l=t(14357),r=t(37301),i=t(29554),a=t(6439),o=t(59483);function s(e){let{children:n,tooltip:t,placement:s="right",offset:u=8}=e,c=(0,l.jsx)("span",{className:"max-w-fit",children:n}),[d,m]=(0,o.Z)(c);return(0,l.jsx)(r.J,{children:(0,l.jsxs)(i.bv,{show:m,placement:s,offset:u,enter:"transition duration-100 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition duration-50 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",portal:!0,autoPlacement:!0,children:[(0,l.jsx)(r.J.Button,{as:a.Fragment,children:d}),(0,l.jsx)(r.J.Panel,{static:!0,className:"rounded p-2 shadow-lg bg-stone-50 dark:bg-stone-700 text-stone-600 dark:text-stone-400 text-sm pointer-events-none",children:t})]})})}},22794:function(e,n,t){t.d(n,{Z:function(){return i},y:function(){return r}});var l=t(30291);let r={borderColor:"red",borderWidth:1,borderAlpha:1,fillAlpha:0,fillColor:"red"};function i(e,n){var t,i;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,[o,s,u,c]=n;(null!==(t=a.borderAlpha)&&void 0!==t?t:1)!==0&&((0,l.F6)(e,a),e.strokeRect(o,s,u-o,c-s)),(null!==(i=a.fillAlpha)&&void 0!==i?i:0)!==0&&((0,l.wi)(e,a),e.fillRect(o,s,u-o,c-s))}},28775:function(e,n,t){t.d(n,{Z:function(){return r},n:function(){return l}});let l={borderColor:"red",borderWidth:1,borderAlpha:1};function r(e,n){var t,r,i,a;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,{canvas:s}=e,{height:u}=s;(null!==(t=o.borderAlpha)&&void 0!==t?t:1)!==0&&(e.globalAlpha=null!==(r=o.borderAlpha)&&void 0!==r?r:1,e.strokeStyle=null!==(i=o.borderColor)&&void 0!==i?i:"red",e.lineWidth=null!==(a=o.borderWidth)&&void 0!==a?a:1,o.borderDash&&e.setLineDash(o.borderDash),e.beginPath(),e.moveTo(n,0),e.lineTo(n,u),e.stroke())}},30291:function(e,n,t){t.d(n,{F6:function(){return f},T:function(){return i},Vb:function(){return r},Yj:function(){return o},_8:function(){return l},cM:function(){return a},g8:function(){return u},j_:function(){return c},mm:function(){return s},wi:function(){return d}});let l="rgb(16 185 129)",r="rgb(59,130,246)",i="rgb(239 68 68)",a="rgb(245 158 11)",o={color:"white"},s={width:1,length:6},u={width:3,length:20};function c(e,n){let{fontFamily:t="system-ui",fontStyle:l="normal",fontWeight:r="normal",fontColor:i="#000000",fontSize:a=12,fontAlpha:o=1,textAlign:s="start",textBaseline:u="top"}=n;e.font="".concat(l," ").concat(r," ").concat(a,"px ").concat(t),e.textAlign=s,e.fillStyle=i,e.textBaseline=u,e.globalAlpha=o}function d(e,n){let{fillAlpha:t=.5,fillColor:l="#ff0000"}=n;e.fillStyle=l,e.globalAlpha=t}let m="#ff0000";function f(e,n){let{borderAlpha:t=1,borderColor:l=m,borderWidth:r=1,borderDash:i}=n;e.strokeStyle=null!=l?l:m,e.lineWidth=null!=r?r:1,e.globalAlpha=null!=t?t:1,null!=i?e.setLineDash(i):e.setLineDash([])}},87283:function(e,n,t){t.d(n,{Z:function(){return a}});var l=t(6439),r=t(91728),i=t(95086);function a(e){let{ref:n,draw:t,onMount:a,onResize:o,onDraw:s,onClear:u,onError:c}=e,[d,m]=(0,l.useState)(null);(0,r.Z)(()=>{var e,t,l,r;let{current:i}=n;if(null==i)return;i.width=null!==(l=null===(e=i.parentElement)||void 0===e?void 0:e.offsetWidth)&&void 0!==l?l:i.offsetWidth,i.height=null!==(r=null===(t=i.parentElement)||void 0===t?void 0:t.offsetHeight)&&void 0!==r?r:i.offsetHeight;let o=i.getContext("2d");if(null==o){i.classList.add("border-2","border-red-500"),null==c||c(i);return}m(o),null==a||a(o)});let f=(0,l.useCallback)(()=>{let{current:e}=n;if(null!=e&&null!=d){var l,r,i,a;e.width=null!==(i=null===(l=e.parentElement)||void 0===l?void 0:l.offsetWidth)&&void 0!==i?i:e.offsetWidth,e.height=null!==(a=null===(r=e.parentElement)||void 0===r?void 0:r.offsetHeight)&&void 0!==a?a:e.offsetHeight,t(d),null==o||o(d)}},[n,d,t,o]);return(0,i.Z)("resize",f,window),(0,l.useEffect)(()=>{if(null!=d)return t(d),null==s||s(d),()=>{let{canvas:e}=d;d.clearRect(0,0,e.width,e.height),null==u||u(d)}},[d,t,s,u]),n}},57142:function(e,n,t){t.d(n,{Z:function(){return a}});var l=t(6439),r=t(22794),i=t(60978);function a(e){let{drag:n,active:t,style:a=r.y,onCreate:o}=e,[s,u]=(0,l.useState)({width:0,height:0}),[c,d]=(0,l.useState)(null),[m,f]=(0,l.useState)(!1),{isDragging:h,start:p,current:g}=(0,i.Z)({dragState:n,active:t}),{elW:x,elH:v}=n;(0,l.useEffect)(()=>{null!=x&&null!=v&&u({width:x,height:v})},[x,v]),(0,l.useEffect)(()=>{t&&(h&&null==c?(f(!0),d(null)):h||null==c||(f(!1),null==o||o({bbox:c,dims:s}),d(null)))},[t,h,c,o,s]),(0,l.useEffect)(()=>{if(t&&null!=p&&null!=g){let e=Math.min(p[0],g[0]),n=Math.max(p[0],g[0]),t=Math.max(p[1],g[1]),l=Math.min(p[1],g[1]);d([e,t,n,l])}},[t,g,p]);let b=(0,l.useCallback)(e=>{t&&m&&null!=c&&(0,r.Z)(e,c,a)},[t,c,m,a]);return{bbox:c,isDrawing:m,draw:b}}},60978:function(e,n,t){t.d(n,{Z:function(){return i}});var l=t(6439),r=t(49763);function i(e){let{dragState:n,active:t=!0,onDragStart:i,onDrag:a,onDragEnd:o}=e,[s,u]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),{isScratching:m,x:f,y:h,dx:p,dy:g}=n;return(0,r.Z)(()=>{t&&(m&&null==s?null!=f&&null!=h&&(u([f,h]),null==i||i([f,h])):m||null==s||(u(null),d(null),null==o||o(null!=c?c:s)))},[m,t,f,h]),(0,r.Z)(()=>{if(t&&null!=s&&m&&null!=p&&null!=g){let[e,n]=s;d([e+p,n+g]),null==a||a([e+p,n+g])}},[t,s,m,p,g]),{isDragging:m&&t,start:s,current:c}}},23076:function(e,n,t){t.d(n,{Z:function(){return o}});var l=t(6439),r=t(65753),i=t(47128),a=t(75263);function o(e){let{active:n=!0,ref:t,...o}=e,s=(0,r.Z)(o),[u,c]=(0,i.Z)({isScratching:!1}),d=(0,l.useRef)(u),m=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{let e,l;if(!n||null==t||null==t.current)return;let r=t.current,i=(e,n)=>{let{left:t,top:l}=r.getBoundingClientRect(),i=t+window.scrollX,a=l+window.scrollY,o=e-i,u=n-a;c(e=>{var n,t;let l={...e,dx:o-(e.x||0),dy:u-(e.y||0),end:Date.now(),isScratching:!0};return d.current=l,null===(n=(t=s.current).onScratch)||void 0===n||n.call(t,l),l})},o=e=>{i(e.pageX,e.pageY)},u=e=>{i(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},f=()=>{var n,t;m.current&&(m.current=!1,d.current={...d.current,isScratching:!1},null===(n=(t=s.current).onScratchEnd)||void 0===n||n.call(t,d.current),c({isScratching:!1}),(0,a.S1)(window,"mousemove",o),(0,a.S1)(window,"touchmove",u),(0,a.S1)(window,"mouseup",e),(0,a.S1)(window,"touchend",l))};e=f,l=f;let h=(n,i)=>{var f,h,p,g,x,v;if(!m.current)return;let{left:b,top:w}=r.getBoundingClientRect(),y=b+window.scrollX,j=w+window.scrollY,T=n-y,k=i-j,S=Date.now(),C={isScratching:!0,start:S,end:S,docX:n,docY:i,x:T,y:k,dx:0,dy:0,elH:null!==(x=null===(f=t.current)||void 0===f?void 0:f.offsetHeight)&&void 0!==x?x:0,elW:null!==(v=null===(h=t.current)||void 0===h?void 0:h.offsetWidth)&&void 0!==v?v:0,elX:y,elY:j};d.current=C,null===(p=(g=s.current).onScratchStart)||void 0===p||p.call(g,C),c(C),(0,a.on)(window,"mousemove",o),(0,a.on)(window,"touchmove",u),(0,a.on)(window,"mouseup",e),(0,a.on)(window,"touchend",l)},p=e=>{m.current=!0,h(e.pageX,e.pageY)},g=e=>{m.current=!0,h(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return(0,a.on)(r,"mousedown",p),(0,a.on)(r,"touchstart",g),()=>{(0,a.S1)(r,"mousedown",p),(0,a.S1)(r,"touchstart",g),(0,a.S1)(window,"mousemove",o),(0,a.S1)(window,"touchmove",u),(0,a.S1)(window,"mouseup",e),(0,a.S1)(window,"touchend",l),m.current=!1,d.current={isScratching:!1},c(d.current)}},[t,n,s,c]),u}},55766:function(e,n,t){t.d(n,{Z:function(){return N}});var l=t(10839),r=t(6439),i=t(49763),a=t(30291);function o(e,n){let t=n.max-n.min,l=Math.floor(Math.log10(50*(t/e)))+1,r=10**l;return t/r<=3&&(r/=2,l-=1),{digits:l,mayorTickStep:r,minorTickStep:r/5}}function s(e,n){return e.toPrecision(Math.floor(Math.log10(e+1))+1-Math.min(n,0))}function u(e,n){let{min:t,max:l}=e,r=Math.floor((l-t)/n)+1,i=Math.ceil(t/n);return Array(r).fill(0).map((e,t)=>(i+t)*n)}function c(e,n){let{label:t,length:l=10,width:r=1,alpha:i=1,color:o="black"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a.F6)(e,{borderColor:o,borderWidth:r,borderAlpha:i,borderDash:[]}),e.beginPath(),e.moveTo(n,0),e.lineTo(n,l),e.stroke(),null!=t&&((0,a.j_)(e,{fontColor:o,textBaseline:"bottom"}),e.fillText(t,n+2,l))}function d(e,n){let{label:t,length:l=10,width:r=1,alpha:i=1,color:o="black"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a.F6)(e,{borderColor:o,borderWidth:r,borderAlpha:i,borderDash:[]}),e.beginPath(),e.moveTo(0,n),e.lineTo(l,n),e.stroke(),null!=t&&(e.save(),e.translate(l,n),e.rotate(-Math.PI/2),(0,a.j_)(e,{fontColor:o,textBaseline:"bottom"}),e.fillText(t,2,0),e.restore())}var m=t(28775),f=t(7460),h=t(95086),p=t(70748),g=t(81361),x=t(9797);function v(e){let{recording_id:n,window:t,parameters:l=x._z,getSpectrogramImageUrl:i=g.Z.spectrograms.getUrl}=e,a=(0,r.useMemo)(()=>i({recording_id:n,segment:t.time,parameters:l}),[n,t.time,l,i]),{isLoading:o,isError:s,image:u}=function(e){let{url:n,timeout:t=3e4,onLoad:l,onError:i,onTimeout:a}=e,o=(0,r.useRef)(null),[s,u]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0);null===o.current&&(o.current=new Image),(0,r.useEffect)(()=>{null!=o.current&&(o.current.src=n,d(!0),u(null))},[n]);let m=(0,r.useCallback)(()=>{u("Took too long to load"),d(!1),null==a||a()},[a]),[g,x]=(0,f.Z)(m,t),v=(0,r.useCallback)(()=>{d(!1),u(null),x(),null==l||l()},[x,l]);(0,h.Z)("load",v,o.current);let b=(0,r.useCallback)(()=>{d(!1),u("Unknown error"),x(),null==i||i()},[x,i]);return(0,h.Z)("error",b,o.current),(0,p.Z)(()=>{x(),null!=o.current&&(o.current.src="")}),{url:n,image:o.current,isLoading:c,isError:null!=s,error:s}}({url:a}),c=(0,r.useCallback)((e,n)=>{if(s)return null;o?e.canvas.classList.add("animate-pluse"):function(e){let{ctx:n,image:t,window:l,bounds:r}=e;n.canvas.setAttribute("class",""),function(e,n,t,l){e.fillStyle="#f8f9fa",e.clearRect(0,0,e.canvas.width,e.canvas.height);let r=l.time,i=l.freq.max,a=r.max-r.min,o=(t.time.min-r.min)/a,s=t.freq.max/i,u=Math.floor(o*n.width),c=Math.floor((1-s)*n.height),d=Math.floor((t.time.max-t.time.min)*n.width/a),m=Math.floor((t.freq.max-t.freq.min)*n.height/i),f=e.canvas.width,h=e.canvas.height;e.globalAlpha=1,e.drawImage(n,u,c,d,m,0,0,f,h)}(n,t,l,r)}({ctx:e,image:u,window:n,bounds:t})},[u,o,s,t]);return{image:u,window:t,draw:c}}let b=[.125,.25,.5,1,2,4,8,16,32,64,128,256];var w=t(89837),y=t(57142);let j={fillAlpha:.3,fillColor:"red",borderWidth:1,borderColor:"red",borderDash:[4,4]};var T=t(75263);function k(e){let{ref:n,preventDefault:t=!0,onScroll:l}=e;(0,r.useEffect)(()=>{let e=n.current,r=e=>{(e.shiftKey||e.ctrlKey||e.altKey)&&(null==l||l({deltaY:e.deltaY,deltaX:e.deltaX,shift:e.shiftKey,ctrl:e.ctrlKey,alt:e.altKey,input:e.target instanceof HTMLInputElement}),t&&e.preventDefault())};return(0,T.on)(e,"wheel",r,!1),()=>(0,T.S1)(e,"wheel",r)})}var S=t(85520);let C=e=>e.context.currentTime;function N(e){let{recording:n,bounds:t,initial:f,state:h,send:p,dragState:g,ref:x}=e;if(null==h.context.audio)throw Error("Audio is not initialized");let T=(0,l.v)(h.context.audio,C);(0,i.Z)(()=>{null!=n&&p({type:"CHANGE_RECORDING",recording:n})},[n,p]),(0,i.Z)(()=>{null!=t&&null!=f&&p({type:"UPDATE",bounds:t,initial:f})},[t,f,p]),function(e){let{drag:n,window:t,active:l,send:i}=e,a=(0,r.useCallback)(e=>{i({type:"PAN_TO",window:e})},[i]);(0,S.Z)({window:t,setWindow:a,active:l,dragState:n})}({active:h.matches("panning"),window:h.context.window,drag:g,send:p}),function(e){let{active:n,send:t,ref:l}=e,i=(0,r.useCallback)((e,n)=>{t({type:"SHIFT_WINDOW",shiftBy:e,relative:n})},[t]);!function(e){let{shiftWindow:n,active:t=!0,ref:l}=e,i=(0,r.useCallback)(e=>{let{deltaY:l,shift:r,ctrl:i,input:a}=e;t&&r&&!i&&0!==l&&!a&&(null==n||n({time:l/2e3,freq:0},!0))},[t,n]);k({ref:l,onScroll:i,preventDefault:!0})}({active:n,shiftWindow:i,ref:l})}({active:!0,send:p,ref:x}),function(e){let{active:n,send:t,ref:l}=e,i=(0,r.useCallback)(e=>{t({type:"SCALE_WINDOW",scaleBy:e})},[t]);!function(e){let{scaleWindow:n,ref:t,active:l=!0}=e,i=(0,r.useCallback)(e=>{let{deltaY:t,shift:r,ctrl:i,input:a}=e;if(l&&0!==t){let e=t>0?1.1:1/1.1;!i||r||a?i&&r&&!a&&(null==n||n({time:1,freq:e})):null==n||n({time:e,freq:1})}},[l,n]);k({ref:t,onScroll:i,preventDefault:!0})}({active:n,scaleWindow:i,ref:l})}({active:!0,send:p,ref:x});let N=function(e){let{window:n,drag:t,active:l=!1,send:i}=e,a=(0,r.useCallback)(e=>{let{bbox:t,dims:l}=e,[r,a,o,s]=(0,w.No)(l,t,n);(function(e){let[n,t,l,r]=e;return!(l-n<.001)&&!(t-r<1)})([r,a,o,s])&&i({type:"ZOOM_TO",window:{time:{min:r,max:o},freq:{min:s,max:a}}})},[n,i]),{draw:o}=(0,y.Z)({drag:t,onCreate:a,active:l,style:j});return o}({window:h.context.window,drag:g,active:h.matches("zooming"),send:p}),M=function(e){let{recording:n,window:t,parameters:l}=e,{selected:i,prev:a,next:o}=function(e){let{recording:n,window:t}=e,l=(0,r.useMemo)(()=>({time:{min:0,max:n.duration},freq:{min:0,max:n.samplerate/2}}),[n]),i=(0,r.useMemo)(()=>{let e=function(e){var n;let t=e.time.max-e.time.min;return null!==(n=b.find(e=>e>=3*t))&&void 0!==n?n:b[b.length-1]}(t),n=function(e,n,t){let l=e.time.max-e.time.min;if(l<=n)return[{time:e.time,freq:e.freq}];let r=.6*n;return Array(Math.ceil((l-r)/r)).fill(0).map((t,l)=>{let i=e.time.min+l*r;return{time:{min:i,max:i+n},freq:e.freq}})}(l,e,0);return n},[l,t]),a=(0,r.useMemo)(()=>(function(e,n){let t=e.map(e=>{let t=(e.time.min+e.time.max)/2,l=(n.time.min+n.time.max)/2;return Math.abs(t-l)});return function(e){if(0===e.length)return -1;let n=e[0],t=0;for(var l=1;l<e.length;l++)e[l]<n&&(t=l,n=e[l]);return t}(t)})(i,t),[i,t]),{prev:o,next:s}=(0,r.useMemo)(()=>{var e,n;let t=null!==(e=i[a-1])&&void 0!==e?e:i[a],l=null!==(n=i[a+1])&&void 0!==n?n:i[a];return{prev:t,next:l}},[i,a]),u=(0,r.useMemo)(()=>i[a],[i,a]);return{selected:u,prev:o,next:s}}({recording:n,window:t}),{draw:s}=v({recording_id:n.id,window:i,parameters:l});return v({recording_id:n.id,window:a,parameters:l}),v({recording_id:n.id,window:o,parameters:l}),s}({recording:h.context.recording,window:h.context.window,parameters:h.context.parameters}),E=function(e){let{active:n,time:t,window:l,send:i}=e;(0,r.useEffect)(()=>{n&&null!=t&&i({type:"CENTER_ON",time:t})},[n,i,t]);let{min:a,max:o}=l.time,s=(0,r.useCallback)(e=>{if(!n||null==t||t<a||t>o)return;let l=Math.ceil(e.canvas.width*(t-a)/(o-a));(0,m.Z)(e,l)},[n,t,a,o]);return s}({active:h.matches("playing"),time:T,window:h.context.window,send:p}),q=h.matches("zooming"),_=h.matches("panning"),{window:A}=h.context,Z=(0,r.useCallback)(e=>{q?e.canvas.style.cursor="zoom-in":_?e.canvas.style.cursor="grab":e.canvas.style.cursor="default",M(e,A),function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Yj,{canvas:l}=e,{width:r}=l,{min:i,max:d}=n,m=d-i,{mayorTickStep:f,minorTickStep:h,digits:p}=o(r,n),g=u(n,f),x=u(n,h);g.forEach(n=>{let l=r*(n-i)/m;c(e,l,{label:s(n,p),...t,...a.g8})}),x.forEach(n=>{let l=r*(n-i)/m;c(e,l,{...t,...a.mm})})}(e,A.time),function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Yj,{canvas:l}=e,{height:r}=l,{min:i,max:c}=n,m=c-i,{mayorTickStep:f,minorTickStep:h,digits:p}=o(r,n),g=u(n,f),x=u(n,h);g.forEach(n=>{let l=r*(c-n)/m;d(e,l,{label:s(n/1e3,p-3),...t,...a.g8})}),x.forEach(n=>{let l=r*(c-n)/m;d(e,l,{...t,...a.mm})})}(e,A.freq),N(e),E(e)},[q,_,N,M,E,A]);return{state:h,send:p,draw:Z}}},85520:function(e,n,t){t.d(n,{Z:function(){return a}});var l=t(6439),r=t(49763);function i(e){let{window:n,offset:{dx:t,dy:l,elH:r,elW:i}}=e;if(null==t||null==l||null==r||null==i)return n;let{min:a,max:o}=n.time,{min:s,max:u}=n.freq,c=(o-a)*t/i,d=(u-s)*l/r;return{time:{min:a-c,max:o-c},freq:{min:s+d,max:u+d}}}function a(e){let{window:n,setWindow:t,dragState:a,active:o=!0,dragFunction:s=i}=e,[u,c]=(0,l.useState)(null),{isScratching:d}=a;(0,r.Z)(()=>{d&&o?c(n):c(null)},[d,o]),(0,r.Z)(()=>{if(o&&null!=u&&d){let e=s({window:u,offset:a});null!=e&&(null==t||t(e))}},[a,o,t,s,u])}},12021:function(e,n,t){t.d(n,{nk:function(){return d}});var l=t(81741),r=t(56205),i=t(32717),a=t(54083);let o={play:e=>{e.audio.play()},pause:e=>{e.audio.pause()},stop:e=>{e.audio.pause(),e.currentTime=e.startTime,e.audio.currentTime=e.startTime/e.speed},seek:(0,l.f0)({currentTime:(e,n)=>(e.audio.currentTime=n.time/e.speed,n.time)}),mute:(0,l.f0)({muted:e=>(e.audio.muted=!0,!0)}),unmute:(0,l.f0)({muted:e=>(e.audio.muted=!1,!1)}),setVolume:(0,l.f0)({volume:(e,n)=>(e.audio.volume=n.volume,n.volume)}),toggleLoop:(0,l.f0)({loop:e=>(e.audio.loop=!e.audio.loop,e.audio.loop)}),setSpeed:(0,l.f0)({speed:(e,n)=>{let t=e.getAudioURL({recording_id:e.recording.id,speed:n.speed});return e.audio.src=t,n.speed}}),changeRecording:(0,l.f0)({recording:(e,n)=>{let t=e.getAudioURL({recording_id:n.recording.id,speed:e.speed});return e.audio.src=t,n.recording}}),setStartTime:(0,l.f0)({startTime:(e,n)=>n.time,currentTime:(e,n)=>(e.audio.currentTime=Math.max(n.time*e.speed,e.audio.currentTime),e.audio.currentTime/e.speed)}),setEndTime:(0,l.f0)({endTime:(e,n)=>n.time,currentTime:(e,n)=>(e.audio.currentTime=Math.min(n.time*e.speed,e.audio.currentTime),e.audio.currentTime/e.speed)}),setTime:(0,l.f0)({currentTime:(e,n)=>n.time})},s=(0,i.C)({predictableActionArguments:!0,schema:{context:{},events:{}},id:"audio",initial:"setup",states:{setup:{invoke:{src:"setupAudio"},always:{target:"stopped"}},stopped:{on:{PLAY:{target:"playing",actions:["play"]}}},playing:{invoke:{src:"playing"},on:{PAUSE:{target:"paused",actions:["pause"]},STOP:{target:"stopped",actions:["stop"]},TOGGLE_LOOP:{actions:["toggleLoop"],target:"playing"},CHANGE_RECORDING:{actions:["changeRecording"],target:"playing"},SET_START_TIME:{actions:["setStartTime"],target:"playing"},SET_END_TIME:{actions:["setEndTime"],target:"playing"}}},paused:{on:{PLAY:{target:"playing",actions:["play"]}}}},on:{SEEK:{actions:["seek"]},MUTE:{actions:["mute"]},UNMUTE:{actions:["unmute"]},SET_VOLUME:{actions:["setVolume"]},TOGGLE_LOOP:{actions:["toggleLoop"]},SET_SPEED:{target:"setup",actions:["setSpeed","stop"]},CHANGE_RECORDING:{actions:["changeRecording"]},SET_START_TIME:{actions:["setStartTime"]},SET_END_TIME:{actions:["setEndTime"]},SET_TIME:{actions:["setTime"]}}},{actions:o,services:{playing:e=>n=>{let t;let l=()=>{let r=e.audio.currentTime*e.speed;if(r>=e.endTime&&!e.loop){n("STOP");return}r>=e.endTime&&e.loop&&n({type:"SEEK",time:e.startTime}),r<e.startTime&&n({type:"SEEK",time:e.startTime}),n({type:"SET_TIME",time:r}),t=requestAnimationFrame(l)};return t=requestAnimationFrame(l),()=>{cancelAnimationFrame(t)}},setupAudio:e=>()=>{let n=new Audio;e.audio=n;let t=e.getAudioURL({recording_id:e.recording.id,speed:e.speed});n.src=t,n.addEventListener("loadedmetadata",()=>{n.currentTime=e.startTime/e.speed})}}});var u=t(81361);let c={play:e=>{var n;null===(n=e.audio)||void 0===n||n.send("PLAY")},pause:e=>{var n;null===(n=e.audio)||void 0===n||n.send("PAUSE")},setParameter:(0,l.f0)({parameters:(e,n)=>m({parameters:{...e.parameters,[n.key]:n.value},recording:e.recording})}),clearParameter:(0,l.f0)({parameters:(e,n)=>{let{[n.key]:t,...l}=e.parameters;return m({parameters:l,recording:e.recording})}}),zoomTo:(0,l.f0)({window:(e,n)=>(0,a.Tn)(n.window,e.bounds)}),panTo:(0,l.f0)({window:(e,n)=>(0,a.Tn)(n.window,e.bounds)}),centerOn:(0,l.f0)({window:(e,n)=>(0,a.Tn)((0,a.AP)(e.window,n),e.bounds)}),shiftWindow:(0,l.f0)({window:(e,n)=>(0,a.Tn)((0,a.o0)(e.window,n.shiftBy,n.relative),e.bounds)}),scaleWindow:(0,l.f0)({window:(e,n)=>(0,a.Tn)((0,a.MN)(e.window,n.scaleBy),e.bounds)}),reset:(0,l.f0)({window:e=>(0,a.Tn)(e.initial,e.bounds)}),update:(0,l.f0)({bounds:(e,n)=>{var t,l;return null===(t=e.audio)||void 0===t||t.send({type:"SET_START_TIME",time:n.bounds.time.min}),null===(l=e.audio)||void 0===l||l.send({type:"SET_END_TIME",time:n.bounds.time.max}),n.bounds},initial:(e,n)=>n.initial,window:(e,n)=>n.initial}),changeRecording:(0,l.f0)({recording:(e,n)=>{var t;return null===(t=e.audio)||void 0===t||t.send({type:"CHANGE_RECORDING",recording:n.recording}),n.recording}}),initAudio:(0,l.f0)({audio:e=>null!=e.audio?e.audio:(0,r.Cs)(s.withContext({audio:new Audio,recording:e.recording,startTime:e.bounds.time.min,endTime:e.bounds.time.max,currentTime:e.bounds.time.min,muted:!1,volume:1,speed:1,loop:!1,getAudioURL:u.Z.audio.getStreamUrl}))})},d=(0,i.C)({predictableActionArguments:!0,schema:{context:{},events:{}},id:"spectrogram",initial:"panning",states:{idle:{},panning:{on:{PAN_TO:{actions:["panTo"]}}},zooming:{on:{ZOOM_TO:{actions:["zoomTo"],target:"panning"}}},playing:{on:{CENTER_ON:{actions:["centerOn"]},PAUSE:"panning"},entry:["play"],exit:["pause"]}},on:{DISABLE:"idle",PAN:"panning",ZOOM:"zooming",PLAY:"playing",RESET:{actions:["reset"],target:"panning"},UPDATE:{actions:["update"]},SET_PARAMETER:{actions:["setParameter"]},CLEAR_PARAMETER:{actions:["clearParameter"]},CHANGE_RECORDING:{actions:["changeRecording"]},SHIFT_WINDOW:{actions:["shiftWindow"]},SCALE_WINDOW:{actions:["scaleWindow"]}},entry:["initAudio"]},{actions:c});function m(e){let{parameters:n,recording:t}=e;if(!t)return n;let l={};if(null!=n.high_freq){var r;let e=n.resample&&null!==(r=n.samplerate)&&void 0!==r?r:t.samplerate;l.high_freq=Math.min(n.high_freq,Math.round(e/2*.95)),null!=n.low_freq&&(l.low_freq=Math.min(n.low_freq,n.high_freq-1))}return{...n,...l}}},89837:function(e,n,t){t.d(n,{$y:function(){return c},MR:function(){return j},No:function(){return d},PT:function(){return M},WC:function(){return b},c0:function(){return i},fM:function(){return E},vZ:function(){return k},w9:function(){return v},zM:function(){return T}});var l=t(89314),r=t(39934);function i(e,n){let[t,l,r,i]=e,[a,o,s,u]=n,c=Math.max(t,a),d=Math.max(l,o),m=Math.min(r,s),f=Math.min(i,u);return c>m||d>f?null:[c,d,m,f]}function a(e,n,t){let{time:l}=n;return l.max===l.min?l.max:t*(e-l.min)/(l.max-l.min)}function o(e,n,t){let{time:l}=n,r=l.max-l.min;return l.min+r*e/t}function s(e,n,t){let{freq:l}=n;return l.max===l.min?l.max:t*(l.max-e)/(l.max-l.min)}function u(e,n,t){let{freq:l}=n,r=l.max-l.min;return l.max-r*e/t}function c(e,n,t){let{width:l,height:r}=e,[i,o,u,c]=n,d=a(i,t,l),m=a(u,t,l),f=s(c,t,r),h=s(o,t,r);return[d,f,m,h]}function d(e,n,t){let{width:l,height:r}=e,[i,a,s,c]=n,d=o(i,t,l),m=o(s,t,l),f=u(a,t,r),h=u(c,t,r);return[d,f,m,h]}function m(e,n,t){let{width:l,height:r}=e,[i,o]=n;return[i=a(i,t,l),o=s(o,t,r)]}function f(e,n,t){let{width:l,height:r}=e,[i,a]=n;return[i=o(i,t,l),a=u(a,t,r)]}function h(e,n,t){return n.map(n=>m(e,n,t))}function p(e,n,t){return n.map(n=>f(e,n,t))}function g(e,n,t){return n.map(n=>h(e,n,t))}function x(e,n,t){return n.map(n=>p(e,n,t))}function v(e,n,t){let{type:l}=n;switch(l){case"TimeStamp":return{...n,coordinates:a(n.coordinates,t,e.width)};case"TimeInterval":return{...n,coordinates:function(e,n,t){let{width:l}=e,[r,i]=n;return[r=a(r,t,l),i=a(i,t,l)]}(e,n.coordinates,t)};case"Point":return{...n,coordinates:m(e,n.coordinates,t)};case"BoundingBox":return{...n,coordinates:c(e,n.coordinates,t)};case"MultiPoint":case"LineString":return{...n,coordinates:h(e,n.coordinates,t)};case"MultiLineString":case"Polygon":return{...n,coordinates:g(e,n.coordinates,t)};case"MultiPolygon":return{...n,coordinates:n.coordinates.map(n=>g(e,n,t))};default:return console.error("Unknown geometry type ".concat(l," at scaling")),n}}function b(e,n,t){let{type:l}=n;switch(l){case"TimeStamp":return{...n,coordinates:o(n.coordinates,t,e.width)};case"TimeInterval":return{...n,coordinates:function(e,n,t){let{width:l}=e,[r,i]=n;return[r=o(r,t,l),i=o(i,t,l)]}(e,n.coordinates,t)};case"BoundingBox":return{...n,coordinates:d(e,n.coordinates,t)};case"Point":return{...n,coordinates:f(e,n.coordinates,t)};case"MultiPoint":case"LineString":return{...n,coordinates:p(e,n.coordinates,t)};case"MultiLineString":case"Polygon":return{...n,coordinates:x(e,n.coordinates,t)};case"MultiPolygon":return{...n,coordinates:n.coordinates.map(n=>x(e,n,t))};default:return console.error("Unknown geometry type ".concat(l," at scaling")),n}}function w(e,n){let[t,l]=e,[r,i]=n;return Math.sqrt((r-t)**2+(i-l)**2)}function y(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,l=function(e,n){let t=n.coordinates.slice(1).map((t,l)=>{let r=n.coordinates[l];return function(e,n){let[t,l]=n,r=w(t,l)**2;if(0===r)return w(e,t);let i=((e[0]-t[0])*(l[0]-t[0])+(e[1]-t[1])*(l[1]-t[1]))/r;i=Math.max(0,Math.min(1,i));let a=[t[0]+i*(l[0]-t[0]),t[1]+i*(l[1]-t[1])];return w(e,a)}(e,[r,t])});return Math.min(...t)}(e,{type:"LineString",coordinates:n.coordinates});return l<t}function j(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;switch(n.type){case"TimeStamp":return function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,[l]=e;return Math.abs(n-l)<t}(e,n.coordinates,t);case"TimeInterval":return function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,[l]=e,[r,i]=n;return l>r-t&&l<i+t}(e,n.coordinates,t);case"BoundingBox":return function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,[l,r]=e,[i,a,o,s]=n;return l>i-t&&l<o+t&&r>a-t&&r<s+t}(e,n.coordinates,t);case"Point":return function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return w(e,n.coordinates)<t}(e,n,t);case"MultiPoint":return function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return Math.min(...n.coordinates.map(n=>w(e,n)))<t}(e,n,t);case"LineString":return y(e,n,t);case"MultiLineString":return function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return n.coordinates.some(n=>y(e,{type:"LineString",coordinates:n},t))}(e,n,t);case"Polygon":return(0,l.Z)(e,n);case"MultiPolygon":return n.coordinates.some(n=>(0,l.Z)(e,{type:"Polygon",coordinates:n}));default:return!1}}function T(e,n,t){let l=t[0]-n[0],r=t[1]-n[1];return{...e,coordinates:e.coordinates.map(e=>e.map(e=>{let[n,t]=e;return[n+l,t+r]}))}}function k(e,n,t){let{type:l}=e;switch(l){case"TimeStamp":return function(e,n,t){let l=t[0]-n[0];return{...e,coordinates:e.coordinates+l}}(e,n,t);case"TimeInterval":return function(e,n,t){let l=t[0]-n[0];return{...e,coordinates:[e.coordinates[0]+l,e.coordinates[1]+l]}}(e,n,t);case"BoundingBox":return function(e,n,t){let l=t[0]-n[0],r=t[1]-n[1];return{...e,coordinates:[e.coordinates[0]+l,e.coordinates[1]+r,e.coordinates[2]+l,e.coordinates[3]+r]}}(e,n,t);case"Point":return function(e,n,t){let l=t[0]-n[0],r=t[1]-n[1],[i,a]=e.coordinates;return{...e,coordinates:[i+l,a+r]}}(e,n,t);case"MultiPoint":return function(e,n,t){let l=t[0]-n[0],r=t[1]-n[1];return{...e,coordinates:e.coordinates.map(e=>{let[n,t]=e;return[n+l,t+r]})}}(e,n,t);case"LineString":return function(e,n,t){let l=t[0]-n[0],r=t[1]-n[1];return{...e,coordinates:e.coordinates.map(e=>[e[0]+l,e[1]+r])}}(e,n,t);case"MultiLineString":return function(e,n,t){let l=t[0]-n[0],r=t[1]-n[1];return{...e,coordinates:e.coordinates.map(e=>e.map(e=>{let[n,t]=e;return[n+l,t+r]}))}}(e,n,t);case"Polygon":return T(e,n,t);case"MultiPolygon":return function(e,n,t){let l=t[0]-n[0],r=t[1]-n[1];return{...e,coordinates:e.coordinates.map(e=>e.map(e=>e.map(e=>{let[n,t]=e;return[n+l,t+r]})))}}(e,n,t);default:throw Error("Cannot shift geometry of unknown type ".concat(l))}}function S(e,n){let{time:t,freq:l}=n,[r,i,a,o]=e.coordinates;return r<=t.max&&a>=t.min&&i<=l.max&&o>=l.min}function C(e,n){let t=E(e);return S({type:"BoundingBox",coordinates:t},n)}function N(e,n){let t=E(e);return S({type:"BoundingBox",coordinates:t},n)}function M(e,n){let{type:t}=e;switch(t){case"TimeStamp":return function(e,n){let{time:t}=n;return e.coordinates>=t.min&&e.coordinates<=t.max}(e,n);case"TimeInterval":return function(e,n){let{time:t}=n,[l,r]=e.coordinates;return r>=t.min&&l<=t.max}(e,n);case"BoundingBox":return S(e,n);case"Point":return function(e,n){let{time:t,freq:l}=n,[r,i]=e.coordinates;return r<=t.max&&r>=t.min&&i<=l.max&&i>=l.min}(e,n);case"MultiPoint":return function(e,n){let{time:t,freq:l}=n;return e.coordinates.some(e=>{let[n,r]=e;return n<=t.max&&n>=t.min&&r<=l.max&&r>=l.min})}(e,n);case"LineString":return C(e,n);case"MultiLineString":return e.coordinates.some(e=>C({type:"LineString",coordinates:e},n));case"Polygon":return N(e,n);case"MultiPolygon":return e.coordinates.some(e=>N({type:"Polygon",coordinates:e},n));default:throw Error("Cannot check if geometry of unknown type ".concat(t," is in window"))}}function E(e){let{type:n}=e;switch(n){case"TimeStamp":return[e.coordinates,0,e.coordinates,5e6];case"TimeInterval":return[e.coordinates[0],0,e.coordinates[1],5e6];case"BoundingBox":return e.coordinates;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return(0,r.Z)(e);default:throw Error("Cannot compute bounding box of unknown geometry type ".concat(n))}}},54083:function(e,n,t){t.d(n,{AP:function(){return s},Hs:function(){return r},MN:function(){return u},Tn:function(){return a},o0:function(){return o}});var l=t(9797);function r(e){let{interval:n,samplerate:t,window_size:r=l.i9,hop_size:i=l.Zm}=e,a=n.max-n.min;return Math.min(a,524288/(Math.floor(Math.floor(r*t)/2)+1)*i)}function i(e,n){let{min:t,max:l}=e,{min:r,max:i}=n,a=Math.max(t,r),o=Math.min(l,i);return a>o?null:{min:a,max:o}}function a(e,n){let t=e.time.max-e.time.min,l=e.freq.max-e.freq.min,r=(e.time.max+e.time.min)/2,a=(e.freq.max+e.freq.min)/2,o=Math.min(Math.max(r,n.time.min+t/2),n.time.max-t/2),s=Math.min(Math.max(a,n.freq.min+l/2),n.freq.max-l/2);return function(e,n){let t=i(e.time,n.time),l=i(e.freq,n.freq);return null==t||null==l?null:{time:t,freq:l}}({time:{min:o-t/2,max:o+t/2},freq:{min:s-l/2,max:s+l/2}},n)}function o(e,n){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{time:l,freq:r}=n;if(t){let{time:n,freq:t}={time:e.time.max-e.time.min,freq:e.freq.max-e.freq.min};l*=n,r*=t}return{time:{min:e.time.min+l,max:e.time.max+l},freq:{min:e.freq.min+r,max:e.freq.max+r}}}function s(e,n){let{time:t,freq:l}=n,r=e.time.max-e.time.min,i=e.freq.max-e.freq.min,a=null!=t?t-r/2:e.time.min,o=null!=t?t+r/2:e.time.max,s=null!=l?l-i/2:e.freq.min,u=null!=l?l+i/2:e.freq.max;return{time:{min:a,max:o},freq:{min:s,max:u}}}function u(e){let{time:n=1,freq:t=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=(e.time.max-e.time.min)*n,r=(e.freq.max-e.freq.min)*t,i=(e.time.max+e.time.min)/2,a=(e.freq.max+e.freq.min)/2;return{time:{min:i-l/2,max:i+l/2},freq:{min:a-r/2,max:a+r/2}}}}}]);