(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7223],{67721:function(e,t,s){Promise.resolve().then(s.bind(s,49821))},49821:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return V}});var n=s(14357),a=s(6439),i=s(32091),l=s(81361),r=s(11441),d=s(54313);let o={},c={};var x=s(90111),u=s.n(x),m=s(40072),h=s(24070),f=s(56793),g=s(29122);function j(e){let{dataset:t,notes:s=[],missing:l=0,newFiles:r=0}=e,d=(0,i.useSearchParams)(),o=(0,a.useMemo)(()=>s.filter(e=>e.note.is_issue).length,[s]);return(0,n.jsxs)(m.Z,{children:[(0,n.jsx)("div",{className:"flex flex-row justify-between",children:(0,n.jsx)(h.H3,{children:"Dataset Overview"})}),(0,n.jsxs)("div",{className:"flex flex-row gap-2 justify-around",children:[(0,n.jsx)(g.Z,{icon:(0,n.jsx)(u(),{href:"/datasets/detail/recordings?".concat(d.toString()),children:(0,n.jsx)(f.se,{className:"h-8 w-8 inline-block text-blue-500"})}),title:"Recordings",value:t.recording_count}),(0,n.jsx)(g.Z,{icon:(0,n.jsx)(f.uN,{className:"h-8 w-8 inline-block text-amber-500"}),title:"Metadata Issues",value:o}),(0,n.jsx)(g.Z,{icon:(0,n.jsx)(f.aN,{className:"h-8 w-8 inline-block text-red-500"}),title:"Missing Files",value:l}),(0,n.jsx)(g.Z,{icon:(0,n.jsx)(f.cy,{className:"h-8 w-8 inline-block text-emerald-500"}),title:"New Files Detected",value:r})]})]})}var v=s(70565),p=s(91293),N=s(52315);function w(){return(0,n.jsx)("div",{children:"No tags used in this dataset. Edit the recordings metadata to add tags."})}function b(e){var t,s;let{popularTags:a}=e,i=null!==(s=null===(t=a[0])||void 0===t?void 0:t[1])&&void 0!==s?s:0,l=(0,N.Z)(e=>e.getTagColor);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["Top ",a.length," by number of recordings tagged"]}),(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("div",{className:"text-sm text-stone-500 text-right pr-2",children:"Tag"}),a.map(e=>{let[t,s]=e;return(0,n.jsx)("div",{className:"flex-row flex justify-end",children:(0,n.jsx)(v.ZP,{tag:t,disabled:!0,...l(t)})},t.id)})]}),(0,n.jsxs)("div",{className:"grow flex flex-col gap-1",children:[(0,n.jsx)("div",{className:"text-sm text-stone-500 whitespace-nowrap text-left",children:"Recordings"}),a.map(e=>{let[t,s]=e;return(0,n.jsx)("div",{className:"flex flex-row items-center h-6 m-px",children:(0,n.jsx)("div",{className:"w-full flex flex-row h-4 overflow-hidden bg-stone-200 rounded-full dark:bg-stone-700",children:(0,n.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-blue-600 dark:bg-blue-400 text-blue-100 dark:text-blue-900",style:{width:"".concat(100*s/i,"%")},children:s})})},t.id)})]})]})]})}function k(e){let{tags:t,isLoading:s=!1,topK:i=5}=e,l=(0,a.useMemo)(()=>(function(e){let t=new Map,s=new Map;return e.forEach(e=>{var n;let{tag:a}=e;s.has(a.id)||s.set(a.id,a),t.set(a.id,(null!==(n=t.get(a.id))&&void 0!==n?n:0)+1)}),Array.from(t.entries()).sort((e,t)=>t[1]-e[1]).map(e=>{let[t,n]=e;return[s.get(t),n]})})(t),[t]),r=l.slice(0,i);return(0,n.jsxs)(m.Z,{children:[(0,n.jsxs)(h.H3,{children:[(0,n.jsx)(f.Dg,{className:"h-6 w-6 inline-block text-emerald-500 mr-2"}),"Tags"]}),s?(0,n.jsx)(p.Z,{}):0===r.length?(0,n.jsx)(w,{}):(0,n.jsx)(b,{popularTags:r})]})}var y=s(11334);function Z(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(f.nQ,{className:"h-6 w-6 inline-block text-emerald-500 mr-2"}),"There are no issues"]})}function _(e){let{notes:t,maxIssues:s=5}=e,i=(0,a.useMemo)(()=>t.filter(e=>e.note.is_issue).slice(0,s),[t,s]);return(0,n.jsx)("ul",{className:"flex flex-col p-2 pl-4 border rounded-md dark:border-stone-800 divide-y divide-dashed divide-stone-300 dark:divide-stone-800 gap-2",children:i.map(e=>(0,n.jsx)(y.Z,{note:e.note,actions:(0,n.jsxs)(u(),{className:"group text-sm text-stone-500 hover:underline hover:decoration-2 decoration-emerald-500/0 hover:decoration-emerald-500/100 hover:underline-offset-2 transition",href:{pathname:"/recordings/",query:{recording_id:e.recording_id}},children:[(0,n.jsx)(f.A5,{className:"h-4 w-4 ml-1 opacity-0 group-hover:opacity-100 inline-block transition"}),"View"]})},e.note.id))})}function S(e){let{notes:t,isLoading:s=!1}=e;return(0,n.jsxs)(m.Z,{children:[(0,n.jsxs)(h.H3,{children:[(0,n.jsx)(f.uH,{className:"h-6 w-6 inline-block text-emerald-500 mr-2"}),"Notes and Issues"]}),s?(0,n.jsx)(p.Z,{}):0===t.length?(0,n.jsx)(Z,{}):(0,n.jsxs)(n.Fragment,{children:["Latest Issues",(0,n.jsx)(_,{notes:t})]})]})}var C=s(89462),M=s(62976),D=s(60169),F=s(91226);function P(e){let{dataset:t}=e,s=(0,i.useRouter)(),a=(0,M.D)({mutationFn:l.Z.datasets.delete,onSuccess:()=>{s.push("/datasets/")}}),r=async()=>{null!=t&&C.ZP.promise(a.mutateAsync(t.id),{loading:"Deleting dataset... please wait",success:"Dataset deleted",error:"Failed to delete dataset"})};return(0,n.jsx)(F.Z,{title:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.aN,{className:"inline-block w-8 h-8 mr-2 text-red-500"}),"Are you sure you want to delete this dataset?"]}),button:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.pJ,{className:"inline-block w-5 h-5 mr-2"}),"Delete Dataset"]}),mode:"text",variant:"danger",children:e=>{let{close:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("p",{children:"This action cannot be undone. This will permanently delete the recordings in the dataset and all associated objects. This includes any annotations, notes, and tags associated with the recordings in this dataset."}),(0,n.jsx)("p",{className:"font-semibold dark:text-red-400 text-red-600",children:"It is not recommended to delete a dataset with recordings that have been annotated."}),(0,n.jsx)("p",{children:"Do you want to proceed?"})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-end gap-2 mt-4",children:[(0,n.jsxs)(D.Z,{tabIndex:0,mode:"text",variant:"danger",onClick:r,children:[(0,n.jsx)(f.pJ,{className:"h-5 w-5 inline-block mr-2"}),"Delete"]}),(0,n.jsxs)(D.Z,{tabIndex:1,mode:"outline",variant:"primary",onClick:t,children:[(0,n.jsx)(f.Tw,{className:"h-5 w-5 inline-block mr-2"}),"Cancel"]})]})]})}})}function I(e){let{dataset:t,downloadLink:s}=e;return(0,n.jsxs)("div",{className:"flex flex-row gap-2 justify-center",children:[null!=s?(0,n.jsx)("a",{href:s,target:"_blank",download:"dataset.json",children:(0,n.jsxs)(D.Z,{mode:"text",variant:"primary",children:[(0,n.jsx)(f._8,{className:"h-5 w-5 inline-block mr-2"})," Download"]})}):null,(0,n.jsx)(P,{dataset:t})]})}var L=s(38338),T=s(35573);function E(e){let{dataset:t,onChange:s}=e;return(0,n.jsxs)(m.Z,{children:[(0,n.jsx)("div",{className:"px-4 sm:px-0",children:(0,n.jsx)("h3",{className:"text-base font-semibold leading-7 text-stone-900 dark:text-stone-200",children:"Dataset Information"})}),(0,n.jsx)("div",{className:"mt-6 border-t border-stone-300 dark:border-stone-700",children:(0,n.jsxs)("dl",{className:"divide-y divide-stone-500",children:[(0,n.jsxs)("div",{className:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0",children:[(0,n.jsx)(L.iV,{children:"Name"}),(0,n.jsx)(L.ue,{value:t.name,onChange:e=>null==s?void 0:s({name:e}),Input:T.II,autoFocus:!0,children:t.name})]}),(0,n.jsxs)("div",{className:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0",children:[(0,n.jsx)(L.iV,{children:"Description"}),(0,n.jsx)(L.ue,{value:t.description,onChange:e=>null==s?void 0:s({description:e}),Input:T.Kx,autoFocus:!0,children:t.description})]}),(0,n.jsxs)("div",{className:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0",children:[(0,n.jsx)(L.iV,{children:"Created On"}),(0,n.jsx)(L.pj,{children:t.created_at.toLocaleString()})]})]})})]})}function z(e){let{dataset:t,onChange:s,downloadLink:i}=e,x=(0,a.useMemo)(()=>({dataset__eq:t.id}),[t.id]),u=function(){let{filter:e=o,pageSize:t=10}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,d.Z)({fixed:e}),{query:n,pagination:a,items:i,total:c}=(0,r.Z)({name:"recording_tags",func:l.Z.recordings.getTags,pageSize:t,filter:s.filter});return{query:n,filter:s,pagination:a,items:i,total:c}}({pageSize:-1,filter:x}),m=function(){let{filter:e=c,pageSize:t=10}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,d.Z)({fixed:e}),{query:n,pagination:a,items:i,total:o}=(0,r.Z)({name:"recording_notes",func:l.Z.recordings.getNotes,pageSize:t,filter:s.filter});return{query:n,filter:s,pagination:a,items:i,total:o}}({pageSize:-1,filter:x});return(0,n.jsxs)("div",{className:"w-100 flex flex-row flex-wrap lg:flex-nowrap gap-8 justify-between",children:[(0,n.jsx)("div",{className:"grow",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,n.jsx)("div",{className:"col-span-2",children:(0,n.jsx)(j,{dataset:t,notes:m.items})}),(0,n.jsx)("div",{className:"col-span-2 xl:col-span-1",children:(0,n.jsx)(k,{tags:u.items,isLoading:u.query.isLoading})}),(0,n.jsx)("div",{className:"col-span-2 xl:col-span-1",children:(0,n.jsx)(S,{notes:m.items,isLoading:m.query.isLoading})})]})}),(0,n.jsxs)("div",{className:"flex flex-col flex-none max-w-sm gap-4",children:[(0,n.jsx)(I,{dataset:t,downloadLink:i}),(0,n.jsx)("div",{className:"sticky top-8",children:(0,n.jsx)(E,{dataset:t,onChange:s})})]})]})}var O=s(95754);function V(){let{dataset:e,onChange:t,downloadLink:s}=(0,a.useContext)(O.vZ);return null==e?(0,i.notFound)():(0,n.jsx)(z,{dataset:e,onChange:t,downloadLink:s})}},38338:function(e,t,s){"use strict";s.d(t,{iV:function(){return o},pj:function(){return d},ue:function(){return c}});var n=s(14357),a=s(6439),i=s(5374),l=s.n(i),r=s(56793);function d(e){let{children:t,className:s,...a}=e;return(0,n.jsx)("dd",{className:l()("mt-1 text-sm leading-6 text-stone-700 dark:text-stone-400 sm:col-span-2 sm:mt-0",s),...a,children:t})}function o(e){let{children:t,className:s,...a}=e;return(0,n.jsx)("dt",{className:l()("text-sm font-medium leading-6 text-stone-900 dark:text-stone-300",s),...a,children:t})}function c(e){let{children:t,Input:s,value:i,onChange:l,...o}=e,[c,x]=(0,a.useState)(!1),[u,m]=(0,a.useState)(i);return c?(0,n.jsx)(d,{children:(0,n.jsx)(s,{value:u,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(l(u),x(!1)),"Escape"===e.key&&(m(i),x(!1))},onBlur:()=>{m(i),x(!1)},onChange:e=>m(e.target.value),...o})}):(0,n.jsxs)(d,{className:"flex flex-row justify-between",children:[t,(0,n.jsx)("button",{onClick:()=>x(!0),className:"text-sm text-stone-500 underline ml-2",children:(0,n.jsx)(r.dY,{className:"w-5 h-5 inline-block text-blue-500"})})]})}},29122:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(14357),a=s(36973);function i(e){let{icon:t,title:s,value:i,isLoading:l=!1,onClick:r}=e;return(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-start",children:[(0,n.jsx)("button",{className:"flex-none cursor-pointer",onClick:r,children:t}),(0,n.jsxs)("div",{className:"flex-grow-0",children:[(0,n.jsx)("div",{className:"inline-flex items-baseline gap-2",children:l?(0,n.jsx)(a.Z,{className:"h-5 w-5",variant:"info"}):(0,n.jsx)("span",{className:"text-xl font-bold",children:i.toLocaleString()})}),(0,n.jsx)("div",{className:"text-sm font-thin",children:s})]})]})}},54313:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(6439),a=s(30485);function i(e){let{fixed:t,debounce:s=500}=e,[i,l]=(0,n.useState)(t),[r,d]=(0,n.useState)(t);(0,n.useEffect)(()=>{l(t),d(t)},[t]);let o=(0,n.useCallback)(e=>void 0!==t[e],[t]);(0,a.Z)(()=>{d(i)},s,[i]);let c=(0,n.useMemo)(()=>Object.keys(i).filter(e=>!o(e)).length,[i,o]);return{filter:r,set:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(!o(e)||s)&&l(s=>({...s,[e]:t}))},get:e=>i[e],clear:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(!o(e)||t)&&l(t=>{let s={...t};return delete s[e],d(s),s})},reset:()=>l(t),submit:()=>{d(i)},size:c,isFixed:o}}},11441:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(6439),a=s(72007);function i(e){var t,s;let{name:i,func:l,pageSize:r,filter:d,enabled:o=!0}=e,[c,x]=(0,n.useState)(0),[u,m]=(0,n.useState)(r),h=[i,c,u,d],f=(0,a.a)(h,()=>l({limit:u,offset:c*u,...d}),{keepPreviousData:!0,enabled:o,refetchOnWindowFocus:!1}),g=Math.ceil((null!==(s=null===(t=f.data)||void 0===t?void 0:t.total)&&void 0!==s?s:0)/u);(0,n.useEffect)(()=>{x(e=>e>=g&&g>0?g-1:e)},[g]);let{items:j,total:v}=(0,n.useMemo)(()=>null==f.data||f.isLoading?{items:[],total:0}:{items:f.data.items,total:f.data.total},[f.data,f.isLoading]);return{items:j,total:v,pagination:{page:c,numPages:g,pageSize:u,setPage:e=>{e>=0&&e<g&&x(e)},setPageSize:e=>{e>0&&m(t=>{var s,n,a,i;let l=Math.ceil((null!==(a=null===(s=f.data)||void 0===s?void 0:s.total)&&void 0!==a?a:0)/e),r=Math.min(c*t,null!==(i=null===(n=f.data)||void 0===n?void 0:n.total)&&void 0!==i?i:0);return x(Math.max(0,Math.min(Math.floor(r/e),l-1))),e})},nextPage:()=>{c<g-1&&x(c+1)},prevPage:()=>{c>0&&x(c-1)},hasNextPage:c<g-1,hasPrevPage:c>0},query:f,queryKey:h}}},32091:function(e,t,s){e.exports=s(2810)},30485:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(6439),a=s(7460);function i(e,t,s){void 0===t&&(t=0),void 0===s&&(s=[]);var i=(0,a.Z)(e,t),l=i[0],r=i[1],d=i[2];return(0,n.useEffect)(d,s),[l,r]}}},function(e){e.O(0,[6949,3372,4564,243,2007,1651,111,3683,422,8821,1361,9803,9999,8702,7431,1744],function(){return e(e.s=67721)}),_N_E=e.O()}]);